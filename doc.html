<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rural HealthCare Solution</title>
    
    <!-- External Scripts -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src='https://meet.jit.si/external_api.js'></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- EmailJS SDK for sending emails from the contact form -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Custom Styles -->
    <style>
        /* Apply custom font */
        body {
            font-family: 'Inter', sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }

        /* --- New Hero Section Slideshow --- */
        #home {
            position: relative;
            overflow: hidden;
        }

        .slideshow-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        .slideshow-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0;
            animation: imageFade 24s infinite;
        }
        
        .slideshow-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: linear-gradient(rgba(17, 24, 39, 0.6), rgba(17, 24, 39, 0.6));
            z-index: 2;
        }

        #home > .container {
             position: relative;
             z-index: 3;
        }
        
        /* Setting different images and animation delays */
        .slideshow-image:nth-child(1) {
            background-image: url('https://images.unsplash.com/photo-1576091160550-2173dba999ef?q=80&w=2070&auto=format&fit=crop');
            animation-delay: 0s;
        }
        .slideshow-image:nth-child(2) {
            background-image: url('https://images.unsplash.com/photo-1622227941212-3bfa61385459?q=80&w=1932&auto=format&fit=crop');
            animation-delay: 6s;
        }
        .slideshow-image:nth-child(3) {
            background-image: url('https://images.unsplash.com/photo-1538108149393-fbbd81895907?q=80&w=2128&auto=format&fit=crop');
            animation-delay: 12s;
        }
        .slideshow-image:nth-child(4) {
            background-image: url('https://images.unsplash.com/photo-1551191834-75c44f51a48c?q=80&w=2070&auto=format&fit=crop');
            animation-delay: 18s;
        }
        
        @keyframes imageFade {
            0% { opacity: 0; transform: scale(1.05); }
            10% { opacity: 1; transform: scale(1); }
            25% { opacity: 1; transform: scale(1); }
            35% { opacity: 0; transform: scale(1.05); }
            100% { opacity: 0; transform: scale(1.05); }
        }

        /* Professional Button Styles */
        .pro-button {
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        .pro-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(0, 0, 0, 0.15);
        }
        .pro-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        /* Input focus glow */
        input:focus, textarea:focus, select:focus {
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.3) !important;
            border-color: #10B981 !important;
        }
        .dark input:focus, .dark textarea:focus, .dark select:focus {
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.4) !important;
            border-color: #34D399 !important;
        }

        /* --- UPDATED: Enhanced Feature Card Animations --- */
        .feature-card {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.6s ease-out, transform 0.4s ease-out, box-shadow 0.4s ease-out, border-color 0.4s;
            border: 1px solid transparent; /* Prepare for hover border */
        }
        .feature-card.is-visible {
            opacity: 1;
            transform: translateY(0);
        }
        .feature-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
            border-color: #10B981;
        }
        .dark .feature-card:hover {
            box-shadow: 0 12px 24px rgba(16, 185, 129, 0.25);
            border-color: #34D399;
        }

        /* --- NEW: Section Title Animation Setup --- */
        .section-title-animate {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        .section-title-animate.is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Navbar scroll shadow */
        #main-header.scrolled {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        .dark #main-header.scrolled {
             background-color: rgba(17, 24, 39, 0.85); /* gray-900 with opacity */
             box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        /* Modal transitions */
        .modal-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex; align-items: center; justify-content: center;
            z-index: 1000; opacity: 0; visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-overlay.active { opacity: 1; visibility: visible; }
        .modal-content {
            background-color: white; padding: 2rem; border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            width: 90%; max-width: 500px;
            transform: scale(0.95) translateY(-20px);
            transition: transform 0.3s ease, background-color 0.3s;
        }
        .modal-overlay.active .modal-content { transform: scale(1) translateY(0); }

        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #a8a8a8; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }
        .dark ::-webkit-scrollbar-track { background: #2d3748; }
        .dark ::-webkit-scrollbar-thumb { background: #718096; }
        .dark ::-webkit-scrollbar-thumb:hover { background: #a0aec0; }

        /* Mobile nav menu transition */
        .nav-links { max-height: 0; overflow: hidden; transition: max-height 0.5s ease-out; }
        .nav-links.active { max-height: 500px; }
        @media (min-width: 1024px) { .nav-links { max-height: none; overflow: visible; } }
        
        /* Login Modal Tabs */
        .login-tab, .hub-tab {
            cursor: pointer;
            padding: 0.5rem 1rem;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
        }
        .login-tab.active, .hub-tab.active {
            color: #10B981;
            border-bottom-color: #10B981;
            font-weight: 600;
        }
        .dark .login-tab.active, .dark .hub-tab.active {
             color: #34D399;
             border-bottom-color: #34D399;
        }
        
        /* Admin Link Style */
        .admin-link {
            background-color: #f0fdf4; /* green-50 */
            color: #166534; /* green-800 */
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-weight: 600;
        }
        .dark .admin-link {
            background-color: rgba(16, 185, 129, 0.2); /* green-500 with opacity */
            color: #a7f3d0; /* green-200 */
        }

        /* Chat Widget */
        #chat-widget-container {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 1000;
        }
        #chat-toggle-btn {
            background-color: #10B981;
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: transform 0.2s ease, background-color 0.2s ease;
        }
        #chat-toggle-btn:hover {
            transform: scale(1.1);
            background-color: #059669;
        }
        #chat-window {
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 350px;
            height: 500px;
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transform-origin: bottom right;
            transition: transform 0.3s ease, opacity 0.3s ease;
            transform: scale(0);
            opacity: 0;
        }
         #chat-window.active {
            transform: scale(1);
            opacity: 1;
        }

        /* Toast Notification System */
        #toast-container {
            position: fixed;
            top: 1.5rem;
            right: 1.5rem;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 0.75rem;
        }

        .toast {
            display: flex;
            align-items: center;
            padding: 1rem 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            transform: translateX(120%);
            transition: transform 0.5s ease-in-out;
            opacity: 0;
            color: white;
            font-weight: 500;
        }
        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }
        .toast.toast-success { background-color: #10B981; }
        .toast.toast-error { background-color: #EF4444; }
        .toast.toast-info { background-color: #3B82F6; }

        /* Generic loading spinner for buttons */
        .button-loader svg {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Password Strength Meter */
        .password-strength-meter {
            height: 5px;
            width: 100%;
            background-color: #e5e7eb;
            border-radius: 5px;
            overflow: hidden;
            transition: all 0.3s;
        }
        .password-strength-bar {
            height: 100%;
            width: 0%;
            border-radius: 5px;
            transition: all 0.4s ease-in-out;
        }
        .strength-weak { background-color: #ef4444; width: 33%;}
        .strength-medium { background-color: #f59e0b; width: 66%;}
        .strength-strong { background-color: #10b981; width: 100%;}
    </style>
</head>
<body class="bg-white text-gray-800 font-sans dark:bg-gray-900 dark:text-gray-200">
    <!-- Toast Notification Container -->
    <div id="toast-container"></div>
    
    <!-- Header and Navigation -->
    <header id="main-header" class="bg-white/80 backdrop-blur-md sticky top-0 z-50 transition-all duration-300 dark:bg-gray-900/80">
        <nav class="container mx-auto px-4 py-4 flex items-center justify-between flex-wrap">
            <div class="flex items-center flex-shrink-0 text-green-700 mr-6 dark:text-green-400">
                <a href="#home" class="nav-link font-bold text-2xl tracking-tight flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-green-500"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="12" x2="12" y1="18" y2="12"></line><line x1="9" x2="15" y1="15" y2="15"></line></svg>
                    <span data-translate-key="nav_title">Rural HealthCare</span>
                </a>
            </div>
            <div class="block lg:hidden">
                <button id="menu-toggle" class="flex items-center px-3 py-2 border rounded text-green-500 border-green-500 hover:text-green-700 hover:border-green-700 dark:text-green-400 dark:border-green-400" aria-controls="nav-links" aria-expanded="false">
                    <svg class="fill-current h-4 w-4" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><title>Menu</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"/></svg>
                </button>
            </div>
            <div id="nav-links" class="nav-links w-full lg:flex lg:items-center lg:w-auto">
                <ul class="text-sm lg:flex-grow lg:flex lg:justify-end lg:items-center list-none space-y-4 lg:space-y-0 lg:space-x-4">
                    <li><a href="#home" class="nav-link block lg:inline-block text-gray-700 hover:text-green-500 dark:text-gray-300 dark:hover:text-green-400 font-medium" data-translate-key="nav_home">Home</a></li>
                    
                    <li class="relative" id="services-dropdown-container">
                        <button id="services-dropdown-toggle" class="flex items-center justify-between w-full lg:w-auto text-left text-gray-700 hover:text-green-500 dark:text-gray-300 dark:hover:text-green-400 font-medium">
                            <span data-translate-key="nav_services">Services</span>
                            <svg class="w-4 h-4 ml-1 transform transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                        </button>
                        <div id="services-dropdown-menu" class="hidden lg:absolute lg:mt-2 w-full lg:w-48 bg-white dark:bg-gray-700 rounded-md shadow-lg z-20">
                            <ul class="py-1">
                                <li><a href="#telemedicine" class="nav-link dropdown-link block px-4 py-2 text-gray-700 hover:bg-green-50 dark:text-gray-300 dark:hover:bg-gray-600 dark:hover:text-green-400" data-translate-key="service_telemedicine">Telemedicine</a></li>
                                <li><a href="#records" class="nav-link dropdown-link block px-4 py-2 text-gray-700 hover:bg-green-50 dark:text-gray-300 dark:hover:bg-gray-600 dark:hover:text-green-400" data-translate-key="service_records">Health Records</a></li>
                                <li><a href="#medicine" class="nav-link dropdown-link block px-4 py-2 text-gray-700 hover:bg-green-50 dark:text-gray-300 dark:hover:bg-gray-600 dark:hover:text-green-400" data-translate-key="service_medicine">Medicine Tracker</a></li>
                                <li><a href="#symptom" class="nav-link dropdown-link block px-4 py-2 text-gray-700 hover:bg-green-50 dark:text-gray-300 dark:hover:bg-gray-600 dark:hover:text-green-400" data-translate-key="service_symptom">Symptom Checker</a></li>
                                <li><a href="#doctors" class="nav-link dropdown-link block px-4 py-2 text-gray-700 hover:bg-green-50 dark:text-gray-300 dark:hover:bg-gray-600 dark:hover:text-green-400" data-translate-key="service_doctors">Our Doctors</a></li>
                            </ul>
                        </div>
                    </li>
                    <li><a href="#doctors" class="nav-link block lg:inline-block text-gray-700 hover:text-green-500 dark:text-gray-300 dark:hover:text-green-400 font-medium" data-translate-key="nav_doctors">Doctors</a></li>
                    <li><a href="#contact" class="nav-link block lg:inline-block text-gray-700 hover:text-green-500 dark:text-gray-300 dark:hover:text-green-400 font-medium" data-translate-key="nav_contact">Contact</a></li>
                    
                    <div id="user-session-view" class="hidden lg:flex items-center space-x-4">
                        <li id="my-record-btn-container" class="hidden"><button id="my-record-btn" class="nav-link block lg:inline-block text-gray-700 hover:text-green-500 dark:text-gray-300 dark:hover:text-green-400 font-medium" data-translate-key="nav_my_record">My Health Record</button></li>
                        <li id="admin-dashboard-btn-container" class="hidden"><button id="admin-dashboard-btn" class="nav-link block lg:inline-block admin-link" data-translate-key="nav_admin_dashboard">Admin Dashboard</button></li>
                        <li class="flex items-center">
                            <span id="welcome-message" class="text-gray-600 dark:text-gray-400 font-medium mr-4"></span>
                            <button id="logout-btn" class="bg-red-500 text-white font-semibold py-2 px-4 rounded-full hover:bg-red-600 transition duration-300 text-xs" data-translate-key="nav_logout">Logout</button>
                        </li>
                    </div>
                    
                    <div id="guest-session-view" class="pt-2 lg:pt-0 lg:ml-4 flex items-center">
                        <li><button id="login-register-btn" class="w-full lg:w-auto bg-green-600 text-white font-semibold py-2 px-5 rounded-full shadow-md hover:bg-green-700 transition duration-300 pro-button" data-translate-key="nav_login_register">Login / Register</button></li>
                    </div>
                     <li class="ml-4">
                        <button id="theme-toggle" class="p-2 rounded-full text-gray-500 hover:bg-gray-200 dark:text-gray-400 dark:hover:bg-gray-700" aria-label="Toggle dark mode">
                            <svg id="theme-toggle-dark-icon" class="w-5 h-5 hidden" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg>
                            <svg id="theme-toggle-light-icon" class="w-5 h-5 hidden" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.707.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"></path></svg>
                        </button>
                    </li>
                    <li class="ml-2">
                        <div class="relative">
                            <select id="language-switcher" class="appearance-none bg-transparent border border-gray-300 dark:border-gray-600 rounded-full py-2 pl-4 pr-8 text-sm focus:outline-none focus:ring-2 focus:ring-green-500">
                                <option value="en">English</option>
                                <option value="pa">ਪੰਜਾਬੀ</option>
                            </select>
                            <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700 dark:text-gray-300">
                                <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </nav>
    </header>

    <!-- Hero Section -->
    <section id="home" class="text-white py-24 md:py-32 px-4 text-center">
         <!-- Slideshow Backgrounds -->
        <div class="slideshow-container">
            <div class="slideshow-image"></div>
            <div class="slideshow-image"></div>
            <div class="slideshow-image"></div>
            <div class="slideshow-image"></div>
            <div class="slideshow-overlay"></div>
        </div>
        
        <div class="container mx-auto">
            <h1 class="text-4xl md:text-6xl font-extrabold leading-tight mb-4 text-shadow-lg" data-translate-key="hero_title">Accessible Healthcare for Rural Communities</h1>
            <p class="text-lg md:text-xl font-light mb-8 max-w-3xl mx-auto text-shadow" data-translate-key="hero_subtitle">
                Secure consultations, offline health records, real-time medicine updates, and AI-powered tools — all in one simple platform.
            </p>
            <div class="flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-4">
                <button onclick="document.getElementById('features-section').scrollIntoView({ behavior: 'smooth' });" class="bg-white text-green-600 font-semibold py-3 px-8 rounded-full shadow-lg hover:bg-green-50 transition duration-300 pro-button" data-translate-key="hero_get_started">Get Started ✨</button>
                <button id="learn-more-btn" class="bg-green-600 border-2 border-green-600 text-white font-semibold py-3 px-8 rounded-full hover:bg-green-700 transition duration-300 pro-button" data-translate-key="hero_learn_more">Learn More</button>
            </div>
        </div>
    </section>

    <!-- Learn More Page Content -->
    <section id="learn-more-page" class="hidden bg-gray-50 dark:bg-gray-800/50 min-h-screen">
        <div class="container mx-auto px-4 py-16 md:py-24">
            <div class="max-w-3xl mx-auto text-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="mx-auto h-20 w-20 text-green-500 mb-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 3v11.25A2.25 2.25 0 006 16.5h12A2.25 2.25 0 0020.25 14.25V3.75M3.75 3h16.5M3.75 3v1.5M20.25 3v1.5M3.75 14.25v1.5M20.25 14.25v1.5M3.75 18v1.5M20.25 18v1.5M3.75 21h16.5M12 6.75h.008v.008H12V6.75z" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 12h12" />
                </svg>
                <h2 class="text-4xl md:text-5xl font-extrabold text-gray-800 dark:text-gray-200 mb-4" data-translate-key="learn_more_title">Expanding Our Horizons</h2>
                <p class="text-lg text-gray-600 dark:text-gray-400 mb-8" data-translate-key="learn_more_subtitle">
                    This page is currently under development as we compile more detailed information about our innovative approach to rural healthcare.
                </p>
                <div class="bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-lg border border-gray-200 dark:border-gray-700 text-left space-y-4">
                     <h3 class="text-xl font-bold text-green-700 dark:text-green-400" data-translate-key="learn_more_coming_soon">What's Coming Soon:</h3>
                     <ul class="list-disc list-inside space-y-2 text-gray-700 dark:text-gray-300">
                         <li data-translate-key="learn_more_mission"><strong>Our Mission:</strong> A deep dive into why we're dedicated to bridging the urban-rural healthcare gap.</li>
                         <li data-translate-key="learn_more_tech"><strong>Technology Breakdown:</strong> An inside look at the low-bandwidth solutions and secure infrastructure powering our platform.</li>
                         <li data-translate-key="learn_more_impact"><strong>Impact Stories:</strong> Testimonials and data showcasing our real-world impact on communities.</li>
                         <li data-translate-key="learn_more_partner"><strong>Partner With Us:</strong> Information for NGOs, doctors, and pharmacies who want to join our network.</li>
                     </ul>
                </div>
                <button id="go-back-btn" class="mt-10 bg-green-600 text-white font-semibold py-3 px-8 rounded-full shadow-lg hover:bg-green-700 transition duration-300 pro-button inline-flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                    <span data-translate-key="learn_more_go_back">Go Back to Homepage</span>
                </button>
            </div>
        </div>
    </section>

    <div id="main-content-container">
        <!-- Features Section -->
        <main id="features-section" class="bg-slate-50 dark:bg-gray-900/50 py-16 md:py-24">
            <div class="container mx-auto px-4">
                <h2 class="text-3xl font-bold text-center mb-16 section-title-animate" data-translate-key="features_title">Our Key Features</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <section id="telemedicine" class="feature-card bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg text-center">
                        <div class="mb-4 text-green-500">
                            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mx-auto"><path d="M16 16v-3a2 2 0 0 0-2-2H3a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h2"></path><path d="M22 8V6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v2"></path><path d="m11.5 11.5 8-8"></path><path d="M20 3.5h-1.5V2"></path><path d="m15 8.5 1.5 1.5"></path></svg>
                        </div>
                        <h3 class="text-xl font-bold text-green-600 dark:text-green-400 mb-2" data-translate-key="feature_video_title">Video Consultancy</h3>
                        <p class="text-gray-600 dark:text-gray-400 mb-4" data-translate-key="feature_video_desc">Secure video consultations with doctors for easy medical prescription advice.</p>
                        <button class="explore-btn text-green-600 dark:text-green-400 hover:underline font-semibold" data-feature="Telemedicine" data-translate-key="feature_explore">Explore →</button>
                    </section>
                    
                    <section id="records" class="feature-card bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg text-center">
                        <div class="mb-4 text-green-500">
                             <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mx-auto"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="12" x2="12" y1="18" y2="12"></line><line x1="9" x2="15" y1="15" y2="15"></line></svg>
                        </div>
                        <h3 class="text-xl font-bold text-green-600 dark:text-green-400 mb-2" data-translate-key="feature_records_title">Digital Health Records</h3>
                        <p class="text-gray-600 dark:text-gray-400 mb-4" data-translate-key="feature_records_desc">Manage and print patient health records with our easy-to-use digital system.</p>
                        <button class="explore-btn text-green-600 dark:text-green-400 hover:underline font-semibold" data-feature="Health Records" data-translate-key="feature_explore">Explore →</button>
                    </section>

                    <section id="medicine" class="feature-card bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg text-center">
                         <div class="mb-4 text-green-500">
                            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mx-auto"><circle cx="7" cy="7" r="5"></circle><circle cx="17" cy="17" r="5"></circle><path d="M12 17.5V14l-2.5 2.5"></path><path d="m14.5 12-2.5 2.5"></path></svg>
                        </div>
                        <h3 class="text-xl font-bold text-green-600 dark:text-green-400 mb-2" data-translate-key="feature_medicine_title">Medicine Availability Tracker</h3>
                        <p class="text-gray-600 dark:text-gray-400 mb-4" data-translate-key="feature_medicine_desc">Get real-time updates from local pharmacies to avoid wasted trips and ensure timely treatment.</p>
                        <button class="explore-btn text-green-600 dark:text-green-400 hover:underline font-semibold" data-feature="Medicine Tracker" data-translate-key="feature_explore">Explore →</button>
                    </section>

                    <section id="symptom" class="feature-card bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg text-center">
                         <div class="mb-4 text-green-500">
                            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mx-auto"><path d="M12 8V4H8"></path><rect x="4" y="12" width="16" height="8"></rect><path d="M12 12v8"></path><path d="M17.5 12a4.5 4.5 0 1 0 0-9 4.5 4.5 0 0 0 0 9Z"></path></svg>
                        </div>
                        <h3 class="text-xl font-bold text-green-600 dark:text-green-400 mb-2" data-translate-key="feature_symptom_title">AI-Powered Symptom Checker</h3>
                        <p class="text-gray-600 dark:text-gray-400 mb-4" data-translate-key="feature_symptom_desc">Optimized for low-bandwidth areas, helping patients identify possible conditions quickly and efficiently.</p>
                        <button class="explore-btn text-green-600 dark:text-green-400 hover:underline font-semibold" data-feature="Symptom Checker" data-translate-key="feature_explore">Explore →</button>
                    </section>

                    <section id="scalable" class="feature-card bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg text-center">
                        <div class="mb-4 text-green-500">
                            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mx-auto"><path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.3.05-3.05a2.5 2.5 0 0 0-3.05-.05c-.84.71-2.3.7-3.05.05Z"></path><path d="M19.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.3.05-3.05a2.5 2.5 0 0 0-3.05-.05c-.84.71-2.3.7-3.05.05Z"></path><path d="M12 10.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.3.05-3.05a2.5 2.5 0 0 0-3.05-.05c-.84.71-2.3.7-3.05.05Z"></path><path d="M12 21.5V17l-2.5 2.5"></path><path d="m14.5 14.5-2.5 2.5"></path><path d="M12 6.5V2l-2.5 2.5"></path><path d="m14.5 4.5-2.5 2.5"></path></svg>
                        </div>
                        <h3 class="text-xl font-bold text-green-600 dark:text-green-400 mb-2" data-translate-key="feature_scalable_title">Scalable Healthcare Model</h3>
                        <p class="text-gray-600 dark:text-gray-400 mb-4" data-translate-key="feature_scalable_desc">A replicable solution deployable across rural regions in India, improving healthcare at scale.</p>
                        <button class="explore-btn text-green-600 dark:text-green-400 hover:underline font-semibold" data-feature="Scalable Model" data-translate-key="feature_explore">Explore →</button>
                    </section>
                    
                    <section id="education" class="feature-card bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg text-center">
                        <div class="mb-4 text-green-500">
                            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mx-auto"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"></path></svg>
                        </div>
                        <h3 class="text-xl font-bold text-green-600 dark:text-green-400 mb-2" data-translate-key="feature_education_title">Health Education Hub</h3>
                        <p class="text-gray-600 dark:text-gray-400 mb-4" data-translate-key="feature_education_desc">Access articles and resources about preventive care and wellness, available in multiple languages.</p>
                        <button class="explore-btn text-green-600 dark:text-green-400 hover:underline font-semibold" data-feature="Health Education" data-translate-key="feature_explore">Explore →</button>
                    </section>
                </div>
            </div>
        </main>

        <!-- Doctors Section -->
        <section id="doctors" class="py-16 md:py-24">
            <div class="container mx-auto px-4">
                <div class="text-center max-w-3xl mx-auto mb-16">
                    <h2 class="text-3xl font-bold mb-4 section-title-animate flex items-center justify-center gap-3" data-translate-key="doctors_title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-green-500"><path d="M18 6V4c0-1.1-.9-2-2-2h-4c-1.1 0-2 .9-2 2v2"></path><path d="M18 6h2c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V8c0-1.1.9-2 2-2h2"></path><path d="M18 6h-2c-1.1 0-2 .9-2 2v2h-4V8c0-1.1-.9-2-2-2H6"></path><path d="M12 12h.01"></path></svg>
                        Meet Our Specialists
                    </h2>
                    <p class="text-gray-600 dark:text-gray-400" data-translate-key="doctors_subtitle">Find the right doctor for your needs. Our specialists are dedicated to providing compassionate care.</p>
                </div>
                
                <!-- Doctor Filter Controls -->
                <div class="flex flex-col md:flex-row gap-4 mb-8 max-w-2xl mx-auto">
                    <input type="search" id="doctor-search" placeholder="Search by doctor's name..." class="w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm p-3 dark:bg-gray-700" data-translate-key="doctors_search_placeholder">
                    <select id="doctor-specialization-filter" class="w-full md:w-64 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm p-3 dark:bg-gray-700">
                        <option value="" data-translate-key="doctors_filter_all">All Specializations</option>
                        <!-- Options will be populated dynamically -->
                    </select>
                </div>

                <div id="doctors-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Doctor cards will be dynamically inserted here -->
                </div>
                 <p id="no-doctors-found" class="text-center text-gray-500 dark:text-gray-400 col-span-full hidden" data-translate-key="doctors_no_results">No doctors match your search criteria.</p>
            </div>
        </section>

        <!-- Footer -->
        <footer id="footer" class="bg-gray-800 text-white py-12 px-4 rounded-t-3xl shadow-inner">
            <div class="container mx-auto grid grid-cols-1 md:grid-cols-3 gap-8 text-center md:text-left">
                <div class="flex flex-col items-center md:items-start">
                    <h4 class="text-xl font-bold mb-2">🌿 Rural HealthCare</h4>
                    <p class="text-gray-400 max-w-xs" data-translate-key="footer_desc">Bringing healthcare closer to underserved communities through technology and innovation.</p>
                    <div class="flex space-x-4 mt-4">
                        <a href="#" class="text-gray-400 hover:text-white"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2.04c-5.5 0-10 4.49-10 10.02 0 5 3.66 9.15 8.44 9.9v-7H7.9v-2.9h2.54V9.84c0-2.5 1.49-3.89 3.78-3.89 1.09 0 2.23.19 2.23.19v2.47h-1.26c-1.24 0-1.63.77-1.63 1.56v1.88h2.78l-.45 2.9h-2.33v7a10 10 0 0 0 8.44-9.9C22 6.53 17.5 2.04 12 2.04z"/></svg></a>
                        <a href="#" class="text-gray-400 hover:text-white"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M22.46 6c-.77.35-1.6.58-2.46.67.88-.53 1.56-1.37 1.88-2.38-.83.49-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98-3.56-.18-6.73-1.89-8.84-4.48-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.22-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.52 8.52 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.5 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"/></svg></a>
                        <a href="#" class="text-gray-400 hover:text-white"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.63 15.34c-.49.2-1.75.87-3.43.48-.13-.03-.25-.09-.37-.15-1.56-.8-2.6-2.16-2.69-2.31-.08-.14-.16-.29-.16-.48s.16-.36.31-.51c.13-.13.28-.15.4-.15s.28.03.4.15l.38.38c.11.11.23.23.37.15.17-.09.84-.42 1.54-1.08.79-.75 1.13-1.59.81-1.98-.31-.38-.72-.45-.99-.45-.19 0-.38.01-.56.01-.2 0-.47 0-.7.42-.23.4-.87 1.48-.87 2.91s.95 2.71 1.08 2.89c.13.18 1.81 2.9 4.41 3.86 2.14.79 2.78.71 3.28.42.5-.29.83-1.2.96-2.32.13-1.12.07-2.07-.05-2.22-.12-.15-.28-.23-.51-.23-.24 0-.49.1-.61.2z"/></svg></a>
                    </div>
                </div>
                <div>
                    <h4 class="text-xl font-bold mb-4" data-translate-key="footer_quick_links">Quick Links</h4>
                    <ul class="space-y-2">
                        <li><a href="#telemedicine" class="hover:text-green-400 transition-colors duration-300" data-translate-key="service_telemedicine">📹 Telemedicine</a></li>
                        <li><a href="#records" class="hover:text-green-400 transition-colors duration-300" data-translate-key="service_records">📁 Health Records</a></li>
                        <li><a href="#medicine" class="hover:text-green-400 transition-colors duration-300" data-translate-key="service_medicine">💊 Medicine Tracker</a></li>
                        <li><a href="#symptom" class="hover:text-green-400 transition-colors duration-300" data-translate-key="service_symptom">🤖 Symptom Checker</a></li>
                        <li><a href="#scalable" class="hover:text-green-400 transition-colors duration-300" data-translate-key="service_scalable">🚀 Scalable Model</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-xl font-bold mb-4" data-translate-key="footer_contact">Contact Us</h4>
                    <ul class="space-y-2">
                        <li>📧 Email: <a href="mailto:support@ruralhealthcare.com" class="hover:text-green-400 transition-colors duration-300">support@ruralhealthcare.com</a></li>
                        <li>📞 Phone: +91-9876543210</li>
                    </ul>
                </div>
            </div>
            <div class="text-center text-gray-400 mt-8 pt-8 border-t border-gray-700">
                <p data-translate-key="footer_copyright">© 2025 Rural HealthCare | Made with ❤️ in India</p>
            </div>
        </footer>
    </div>

    <!-- Login/Register Modal -->
    <div id="login-register-modal" class="modal-overlay">
        <div class="modal-content dark:bg-gray-800 w-full max-w-md">
            <div class="flex justify-between items-center">
                <h4 id="auth-modal-title" class="text-2xl font-bold" data-translate-key="auth_login_title">Login</h4>
                <button class="close-modal-btn font-bold text-3xl leading-none" aria-label="Close modal">×</button>
            </div>
            
            <div class="border-b border-gray-200 dark:border-gray-600 mb-4">
                <nav class="-mb-px flex space-x-6" id="auth-tabs">
                    <button class="login-tab active" data-role="patient" data-translate-key="auth_role_patient">Patient</button>
                    <button class="login-tab" data-role="doctor" data-translate-key="auth_role_doctor">Doctor</button>
                    <button class="login-tab" data-role="admin" data-translate-key="auth_role_admin">App Admin</button>
                </nav>
            </div>

            <form id="login-form" class="space-y-4">
                <input type="hidden" id="login-role" value="patient">
                <div>
                    <label for="login-email" class="block text-gray-700 dark:text-gray-300 font-medium mb-1" data-translate-key="auth_email">Email Address</label>
                    <input type="email" id="login-email" class="w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm p-3 dark:bg-gray-700" required>
                </div>
                <div>
                    <label for="login-password" class="block text-gray-700 dark:text-gray-300 font-medium mb-1" data-translate-key="auth_password">Password</label>
                    <div class="relative">
                        <input type="password" id="login-password" class="w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm p-3 pr-10 dark:bg-gray-700" required>
                        <button type="button" class="password-toggle-btn absolute inset-y-0 right-0 px-3 flex items-center text-gray-500" aria-label="Toggle password visibility"></button>
                    </div>
                </div>
                <p id="login-error" class="text-red-500 text-sm text-center hidden">Invalid credentials or role.</p>
                <button type="submit" class="w-full bg-green-600 text-white font-semibold py-3 rounded-full shadow-lg hover:bg-green-700 transition duration-300 pro-button">
                    <span class="button-text" data-translate-key="auth_login_btn">Login</span>
                    <span class="button-loader hidden"><svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></span>
                </button>
                <p class="text-center text-sm text-gray-600 dark:text-gray-400">
                    <span data-translate-key="auth_no_account">Don't have an account?</span> <button type="button" id="switch-to-register-btn" class="font-semibold text-green-600 hover:underline dark:text-green-400" data-translate-key="auth_register_now">Register Now</button>
                </p>
            </form>

            <form id="register-form" class="space-y-4 hidden">
                <input type="hidden" id="register-role" value="patient">
                <div>
                    <label for="register-name" class="block text-gray-700 dark:text-gray-300 font-medium mb-1" data-translate-key="auth_full_name">Full Name</label>
                    <input type="text" id="register-name" class="w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm p-3 dark:bg-gray-700" required>
                </div>
                <div>
                    <label for="register-email" class="block text-gray-700 dark:text-gray-300 font-medium mb-1" data-translate-key="auth_email">Email Address</label>
                    <input type="email" id="register-email" class="w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm p-3 dark:bg-gray-700" required>
                </div>
                <div>
                    <label for="register-password" class="block text-gray-700 dark:text-gray-300 font-medium mb-1" data-translate-key="auth_create_password">Create Password</label>
                    <div class="relative">
                        <input type="password" id="register-password" class="w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm p-3 pr-10 dark:bg-gray-700" required>
                        <button type="button" class="password-toggle-btn absolute inset-y-0 right-0 px-3 flex items-center text-gray-500" aria-label="Toggle password visibility"></button>
                    </div>
                     <div class="mt-2">
                         <div class="password-strength-meter">
                             <div id="password-strength-bar" class="password-strength-bar"></div>
                         </div>
                         <p id="password-strength-text" class="text-xs text-gray-500 mt-1"></p>
                     </div>
                </div>
                <div id="doctor-id-field" class="hidden">
                    <label for="doctor-id" class="block text-gray-700 dark:text-gray-300 font-medium mb-1" data-translate-key="auth_license_id">Medical License ID</label>
                    <input type="text" id="doctor-id" class="w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm p-3 dark:bg-gray-700" placeholder="e.g., MED12345">
                </div>
                <p id="register-error" class="text-red-500 text-sm text-center hidden"></p>
                <button type="submit" class="w-full bg-green-600 text-white font-semibold py-3 rounded-full shadow-lg hover:bg-green-700 transition duration-300 pro-button">
                    <span class="button-text" data-translate-key="auth_create_account_btn">Create Account</span>
                    <span class="button-loader hidden"><svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></span>
                </button>
                <p class="text-center text-sm text-gray-600 dark:text-gray-400">
                    <span data-translate-key="auth_already_account">Already have an account?</span> <button type="button" id="switch-to-login-btn" class="font-semibold text-green-600 hover:underline dark:text-green-400" data-translate-key="auth_login_now">Login</button>
                </p>
            </form>
        </div>
    </div>
    
    <!-- Scalable Model Modal -->
    <div id="scalable-model-modal" class="modal-overlay">
        <div class="modal-content dark:bg-gray-800 w-full max-w-4xl flex flex-col max-h-[90vh]">
            <div class="flex justify-between items-center mb-6 flex-shrink-0">
                <h4 class="text-2xl font-bold flex items-center gap-3" data-translate-key="scalable_title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-green-500"><path d="M2 21a8 8 0 0 1 11.873-6.494M16 16a3 3 0 1 1 0-6 3 3 0 0 1 0 6Z"/><path d="M19.07 19.07a8 8 0 0 1-8.586-1.93M17.5 17.5 22 22"/><path d="M22 11.5V13a10 10 0 1 1-5.93-9.14"/></svg>
                    Our Scalable Healthcare Model
                </h4>
                <button class="close-modal-btn font-bold text-3xl leading-none" aria-label="Close modal">×</button>
            </div>
            
            <div class="overflow-y-auto -mr-4 pr-4">
                <p class="text-center text-gray-600 dark:text-gray-400 mb-8" data-translate-key="scalable_desc">
                    Our platform is designed from the ground up to be a replicable, low-cost solution that can be rapidly deployed across numerous rural regions, creating a widespread network of accessible healthcare.
                </p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8 text-left">
                    <div class="bg-gray-50 dark:bg-gray-700/50 p-5 rounded-lg flex items-start gap-4 border border-gray-200 dark:border-gray-700">
                        <div class="flex-shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2h1a2 2 0 002-2v-1a2 2 0 012-2h1.945M7.881 4.002l-.425 1.063a2 2 0 01-3.35 1.257l-1.063-.425a2 2 0 01-1.257-3.35l.425-1.063a2 2 0 013.35-1.257l1.063.425a2 2 0 011.257 3.35zM16.119 4.002l.425 1.063a2 2 0 003.35 1.257l1.063-.425a2 2 0 001.257-3.35l-.425-1.063a2 2 0 00-3.35-1.257l-1.063.425a2 2 0 00-1.257 3.35zM12 21a9 9 0 100-18 9 9 0 000 18z" />
                            </svg>
                        </div>
                        <div>
                            <h5 class="font-bold mb-1" data-translate-key="scalable_cloud_title">Cloud-Powered Infrastructure</h5>
                            <p class="text-sm text-gray-600 dark:text-gray-400" data-translate-key="scalable_cloud_desc">Built on modern, serverless technology (Supabase) that automatically scales to meet demand, ensuring reliable service whether we're serving one village or a thousand.</p>
                        </div>
                    </div>
                    <div class="bg-gray-50 dark:bg-gray-700/50 p-5 rounded-lg flex items-start gap-4 border border-gray-200 dark:border-gray-700">
                         <div class="flex-shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071a7.5 7.5 0 0110.606 0M15.889 9.171a5.5 5.5 0 010 7.778M5.556 16.404a7.5 7.5 0 010-10.606M12 6h.01M18.444 9.171a7.5 7.5 0 010 10.606M12 2a10 10 0 110 20 10 10 0 010-20z" />
                            </svg>
                        </div>
                        <div>
                            <h5 class="font-bold mb-1" data-translate-key="scalable_bandwidth_title">Low-Bandwidth Optimization</h5>
                            <p class="text-sm text-gray-600 dark:text-gray-400" data-translate-key="scalable_bandwidth_desc">Our features, from the AI symptom checker to record management, are designed to work efficiently on weak or intermittent internet connections, crucial for rural accessibility.</p>
                        </div>
                    </div>
                     <div class="bg-gray-50 dark:bg-gray-700/50 p-5 rounded-lg flex items-start gap-4 border border-gray-200 dark:border-gray-700">
                        <div class="flex-shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M11 4a2 2 0 114 0v1a1 1 0 001 1h3a1 1 0 011 1v3a1 1 0 01-1 1h-1a2 2 0 100 4h1a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-1a2 2 0 10-4 0v1a1 1 0 01-1 1H7a1 1 0 01-1-1v-3a1 1 0 00-1-1H4a2 2 0 110-4h1a1 1 0 001-1V7a1 1 0 011-1h3a1 1 0 001-1V4z" />
                            </svg>
                        </div>
                        <div>
                            <h5 class="font-bold mb-1" data-translate-key="scalable_deployment_title">Rapid Deployment Model</h5>
                            <p class="text-sm text-gray-600 dark:text-gray-400" data-translate-key="scalable_deployment_desc">A standardized setup process allows us to quickly onboard new doctors, pharmacies, and communities, establishing a new "Health Hub" with minimal technical overhead.</p>
                        </div>
                    </div>
                     <div class="bg-gray-50 dark:bg-gray-700/50 p-5 rounded-lg flex items-start gap-4 border border-gray-200 dark:border-gray-700">
                        <div class="flex-shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M17 14v6m-3-3h6M6 10h2a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v2a2 2 0 002 2zm10 0h2a2 2 0 002-2V6a2 2 0 00-2-2h-2a2 2 0 00-2 2v2a2 2 0 002 2zM6 20h2a2 2 0 002-2v-2a2 2 0 00-2-2H6a2 2 0 00-2 2v2a2 2 0 002 2z" />
                            </svg>
                        </div>
                        <div>
                            <h5 class="font-bold mb-1" data-translate-key="scalable_modular_title">Modular & Adaptable</h5>
                            <p class="text-sm text-gray-600 dark:text-gray-400" data-translate-key="scalable_modular_desc">The system is built with distinct modules (Telemedicine, Records, etc.), allowing us to adapt the platform to the specific needs of a community or add new features in the future.</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-green-50 dark:bg-green-900/40 p-6 rounded-lg text-center border border-green-200 dark:border-green-800">
                    <h5 class="text-xl font-bold text-green-800 dark:text-green-300 mb-2" data-translate-key="scalable_partner_title">Partner With Us</h5>
                    <p class="text-green-700 dark:text-green-400 mb-4" data-translate-key="scalable_partner_desc">Are you an NGO, doctor, or a local government body interested in bringing our solution to your community? We'd love to connect.</p>
                    <a href="#contact" class="nav-link bg-green-600 text-white font-semibold py-2 px-6 rounded-full shadow-lg hover:bg-green-700 transition duration-300 pro-button inline-block" data-translate-key="footer_contact">Contact Us</a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- All other modals -->
    <div id="feature-modal" class="modal-overlay">
        <div class="modal-content dark:bg-gray-800 text-center">
            <h4 id="modal-title" class="text-2xl font-bold mb-4"></h4>
            <p id="modal-text" class="text-gray-700 dark:text-gray-300 mb-6"></p>
            <button class="close-modal-btn bg-green-600 text-white font-semibold py-2 px-6 rounded-full shadow-lg hover:bg-green-700 transition duration-300 pro-button">Close</button>
        </div>
    </div>
    
    <div id="telemedicine-modal" class="modal-overlay">
        <div class="modal-content dark:bg-gray-800 w-full max-w-4xl">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-gray-800 dark:text-gray-200" data-translate-key="telemedicine_title">Telemedicine Consultation</h2>
                <button class="close-modal-btn font-bold text-3xl leading-none" aria-label="Close modal">×</button>
            </div>
            <div class="p-6">
                <form id="connect-form">
                    <p class="text-gray-600 dark:text-gray-400 mb-4" data-translate-key="telemedicine_desc">Enter your name and the Meeting ID provided by your doctor.</p>
                    <div class="mb-4">
                        <label for="patient-name" class="block text-sm font-medium text-gray-700 dark:text-gray-300" data-translate-key="auth_full_name">Full Name</label>
                        <input type="text" id="patient-name" class="mt-1 block w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-2 dark:bg-gray-700" placeholder="e.g., Jane Doe" required>
                    </div>
                    <div class="mb-4">
                        <label for="jitsi-meeting-id" class="block text-sm font-medium text-gray-700 dark:text-gray-300" data-translate-key="telemedicine_meeting_id">Meeting ID</label>
                        <input type="text" id="jitsi-meeting-id" class="mt-1 block w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-2 dark:bg-gray-700" placeholder="e.g., DoctorSmithsVirtualRoom" required>
                    </div>
                    <p id="form-error" class="text-red-500 text-sm mb-4 hidden" data-translate-key="telemedicine_error">Please fill out all required fields.</p>
                    <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition pro-button" data-translate-key="telemedicine_join_btn">Join Meeting</button>
                </form>
                <div id="jitsi-container" class="hidden w-full h-[550px] mt-4 rounded-lg overflow-hidden"></div>
            </div>
        </div>
    </div>

    <div id="records-management-modal" class="modal-overlay">
        <div class="modal-content dark:bg-gray-800 w-full max-w-4xl flex flex-col max-h-[90vh]">
            <div class="flex justify-between items-center mb-6 flex-shrink-0">
                <h4 class="text-2xl font-bold" data-translate-key="records_title">Patient Records Management</h4>
                <button class="close-modal-btn font-bold text-3xl leading-none" aria-label="Close modal">×</button>
            </div>
            
            <div class="overflow-y-auto -mr-4 pr-4">
                <div id="records-grid" class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div id="add-patient-column" class="bg-gray-50 dark:bg-gray-700/50 p-6 rounded-lg border dark:border-gray-600">
                        <h5 class="text-lg font-semibold mb-4 border-b pb-2 dark:border-gray-600" data-translate-key="records_add_patient_title">Add New Patient Record</h5>
                        <form id="add-patient-form" class="space-y-4">
                            <div>
                                <label for="new-patient-name" class="block text-sm font-medium text-gray-700 dark:text-gray-300" data-translate-key="auth_full_name">Full Name</label>
                                <input type="text" id="new-patient-name" class="mt-1 w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-2 dark:bg-gray-900" required>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                   <label for="new-patient-dob" class="block text-sm font-medium text-gray-700 dark:text-gray-300" data-translate-key="records_dob">Date of Birth</label>
                                   <input type="date" id="new-patient-dob" class="mt-1 w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-2 dark:bg-gray-900" required>
                                </div>
                                <div>
                                   <label for="new-patient-gender" class="block text-sm font-medium text-gray-700 dark:text-gray-300" data-translate-key="records_gender">Gender</label>
                                   <select id="new-patient-gender" class="mt-1 w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-2 dark:bg-gray-900">
                                       <option data-translate-key="records_male">Male</option>
                                       <option data-translate-key="records_female">Female</option>
                                       <option data-translate-key="records_other">Other</option>
                                   </select>
                                </div>
                            </div>
                            <div>
                                <label for="patient-user-email" class="block text-sm font-medium text-gray-700 dark:text-gray-300" data-translate-key="records_patient_email">Patient's Registered Email (Optional)</label>
                                <input type="email" id="patient-user-email" class="mt-1 w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-2 dark:bg-gray-900" data-translate-key="records_patient_email_placeholder" placeholder="Links record to patient's account">
                            </div>
                            <div class="text-right">
                                <button type="submit" class="bg-green-600 text-white font-semibold py-2 px-6 rounded-full shadow-lg hover:bg-green-700 transition duration-300 pro-button">
                                    <span class="button-text" data-translate-key="records_add_patient_btn">Add Patient</span>
                                    <span class="button-loader hidden"><svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></span>
                                </button>
                            </div>
                        </form>
                    </div>

                    <div id="patient-list-column">
                          <h5 class="text-lg font-semibold mb-4 border-b pb-2 dark:border-gray-600" data-translate-key="records_current_patients">Current Patients</h5>
                          <div id="patient-list-container" class="space-y-3">
                              <!-- Patient list will be dynamically populated -->
                          </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="patient-detail-modal" class="modal-overlay">
        <div class="modal-content dark:bg-gray-800 w-full max-w-4xl flex flex-col max-h-[90vh]">
             <div class="flex justify-between items-center mb-4 flex-shrink-0">
                <div>
                    <h4 id="detail-patient-name" class="text-2xl font-bold">Patient Details</h4>
                    <p id="detail-patient-info" class="text-sm text-gray-500 dark:text-gray-400"></p>
                </div>
                <button class="close-modal-btn font-bold text-3xl leading-none" aria-label="Close modal">×</button>
            </div>
            <div class="overflow-y-auto -mr-4 pr-4">
                 <div class="mb-6">
                    <h5 class="text-lg font-semibold mb-4 border-b pb-2 dark:border-gray-600" data-translate-key="consultation_add_title">Add New Consultation</h5>
                      <form id="add-consultation-form" class="space-y-4 bg-gray-50 dark:bg-gray-700/50 p-6 rounded-lg border dark:border-gray-600">
                        <input type="hidden" id="consultation-patient-id">
                        <div>
                            <label for="consultation-symptoms" class="block text-sm font-medium text-gray-700 dark:text-gray-300" data-translate-key="consultation_symptoms">Symptoms</label>
                            <textarea id="consultation-symptoms" rows="3" class="mt-1 w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-2 dark:bg-gray-900" required></textarea>
                        </div>
                         <div>
                            <label for="consultation-diagnosis" class="block text-sm font-medium text-gray-700 dark:text-gray-300" data-translate-key="consultation_diagnosis">Diagnosis</label>
                            <textarea id="consultation-diagnosis" rows="2" class="mt-1 w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-2 dark:bg-gray-900" required></textarea>
                        </div>
                        <div>
                            <label for="consultation-prescription" class="block text-sm font-medium text-gray-700 dark:text-gray-300" data-translate-key="consultation_prescription">Prescription</label>
                            <textarea id="consultation-prescription" rows="3" class="mt-1 w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-2 dark:bg-gray-900"></textarea>
                        </div>
                         <div>
                            <label for="consultation-notes" class="block text-sm font-medium text-gray-700 dark:text-gray-300" data-translate-key="consultation_notes">Additional Notes</label>
                            <textarea id="consultation-notes" rows="2" class="mt-1 w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-2 dark:bg-gray-900"></textarea>
                        </div>
                        <div class="text-right">
                            <button type="submit" class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-full shadow-lg hover:bg-blue-700 transition duration-300 pro-button">
                                <span class="button-text" data-translate-key="consultation_save_btn">Save Consultation</span>
                                <span class="button-loader hidden"><svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></span>
                            </button>
                        </div>
                    </form>
                </div>
                <div>
                    <div class="flex justify-between items-center mb-4 border-b pb-2 dark:border-gray-600">
                        <h5 class="text-lg font-semibold" data-translate-key="consultation_history_title">Consultation History</h5>
                         <button id="generate-report-btn" class="bg-gray-600 text-white text-sm font-semibold py-1 px-4 rounded-full hover:bg-gray-700 transition" data-translate-key="consultation_report_btn">Generate Full Report</button>
                    </div>
                      <div id="consultation-list-container" class="space-y-4">
                        <p class="text-gray-500 text-center">No consultations recorded yet.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="record-preview-modal" class="modal-overlay">
        <div class="modal-content dark:bg-gray-800 w-full max-w-xl">
             <div class="flex justify-between items-center mb-4">
                <h4 class="text-2xl font-bold" data-translate-key="report_title">Patient Health Record</h4>
                <button class="close-modal-btn font-bold text-3xl leading-none" aria-label="Close modal">×</button>
            </div>
            <div id="modal-record-content" class="bg-gray-50 dark:bg-gray-900/50 border border-gray-200 dark:border-gray-600 rounded-lg p-6 text-sm font-mono whitespace-pre-wrap max-h-96 overflow-y-auto">
            </div>
            <div class="flex items-center justify-center space-x-4 mt-6">
                <button id="print-record-btn" class="bg-gray-300 text-gray-800 font-semibold py-2 px-6 rounded-full hover:bg-gray-400 transition duration-300 pro-button" data-translate-key="report_print_btn">🖨️ Print</button>
                <button id="download-record-btn" class="bg-green-600 text-white font-semibold py-2 px-6 rounded-full shadow-lg hover:bg-green-700 transition duration-300 pro-button" data-translate-key="report_download_btn">📄 Download</button>
            </div>
        </div>
    </div>
    
    <div id="medicine-tracker-modal" class="modal-overlay">
        <div class="modal-content dark:bg-gray-800 w-full max-w-lg">
             <div class="flex justify-between items-center mb-4">
                <h4 class="text-2xl font-bold" data-translate-key="medicine_modal_title">Medicine Availability Tracker</h4>
                <button class="close-modal-btn font-bold text-3xl leading-none" aria-label="Close modal">×</button>
            </div>
            <p class="text-center text-gray-600 dark:text-gray-400 mb-6" data-translate-key="medicine_modal_desc">Search for a medicine to find it in nearby pharmacies.</p>
            <form id="medicine-search-form" class="flex items-center mb-6">
                <input type="search" id="medicine-search-input" placeholder="e.g., Paracetamol" class="shadow-sm appearance-none border dark:border-gray-600 rounded-l-lg w-full py-2 px-4 text-gray-700 dark:text-gray-200 dark:bg-gray-700 leading-tight focus:outline-none focus:ring-2">
                <button type="submit" class="bg-green-600 text-white font-semibold py-2 px-4 rounded-r-lg shadow-lg hover:bg-green-700 transition duration-300 pro-button" data-translate-key="medicine_search_btn">Search</button>
            </form>
            <div id="loading-spinner" class="text-center p-4 hidden">
                <svg class="animate-spin h-8 w-8 text-green-600 dark:text-green-400 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                <p class="mt-2 text-gray-600 dark:text-gray-400" data-translate-key="medicine_loading">Searching for pharmacies...</p>
            </div>
            <div id="no-results-message" class="text-center p-4 bg-gray-100 dark:bg-gray-700/50 rounded-lg hidden">
                <p class="text-gray-700 dark:text-gray-300 font-medium" data-translate-key="medicine_no_results">No results found for your search.</p>
                <p class="text-sm text-gray-500 dark:text-gray-400" data-translate-key="medicine_no_results_desc">Please check the spelling or try a different medicine.</p>
            </div>
            <div id="medicine-results-container" class="space-y-4 max-h-64 overflow-y-auto pr-2">
            </div>
        </div>
    </div>

    <div id="medical-hub-dashboard-modal" class="modal-overlay">
        <div class="modal-content dark:bg-gray-800 w-full max-w-4xl flex flex-col max-h-[90vh]">
            <div class="flex justify-between items-center mb-6 flex-shrink-0">
                <h4 class="text-2xl font-bold" data-translate-key="hub_title">Medical Hub Dashboard</h4>
                <button class="close-modal-btn font-bold text-3xl leading-none" aria-label="Close modal">×</button>
            </div>
            
            <div class="border-b border-gray-200 dark:border-gray-600 mb-4">
                <nav class="-mb-px flex space-x-6" id="hub-tabs">
                    <button class="hub-tab active" data-tab="doctors" data-translate-key="hub_manage_doctors">Manage Doctors</button>
                    <button class="hub-tab" data-tab="admins" data-translate-key="hub_manage_admins">Manage Admins</button>
                </nav>
            </div>

            <div class="overflow-y-auto -mr-4 pr-4">
                 <div id="hub-doctors-view" class="hidden">
                      <div class="bg-gray-50 dark:bg-gray-700/50 p-6 rounded-lg border dark:border-gray-600 mb-6">
                         <h5 class="text-lg font-semibold mb-4 border-b pb-2 dark:border-gray-600" data-translate-key="hub_add_doctor">Add New Doctor</h5>
                         <form id="add-doctor-form" class="space-y-4"></form>
                     </div>
                     <div>
                         <h5 class="text-lg font-semibold mb-4 border-b pb-2 dark:border-gray-600" data-translate-key="hub_registered_doctors">Registered Doctors</h5>
                         <div id="existing-doctors-list" class="space-y-3"></div>
                     </div>
                 </div>
                <div id="hub-admins-view" class="hidden">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="bg-gray-50 dark:bg-gray-700/50 p-6 rounded-lg border dark:border-gray-600">
                            <h5 class="text-lg font-semibold mb-4 border-b pb-2 dark:border-gray-600" data-translate-key="hub_add_admin">Add New Admin</h5>
                            <form id="add-admin-form" class="space-y-4">
                                <div>
                                    <label for="new-admin-email" class="block text-sm font-medium text-gray-700 dark:text-gray-300" data-translate-key="hub_user_email">User's Email</label>
                                    <input type="email" id="new-admin-email" class="mt-1 w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-2 dark:bg-gray-900" required data-translate-key="hub_user_email_placeholder" placeholder="User must be registered">
                                </div>
                                <div class="text-right">
                                    <button type="submit" class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-full shadow-lg hover:bg-blue-700 pro-button">
                                        <span class="button-text" data-translate-key="hub_promote_btn">Promote to Admin</span>
                                        <span class="button-loader hidden"><svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></span>
                                    </button>
                                </div>
                            </form>
                        </div>
                        <div>
                            <h5 class="text-lg font-semibold mb-4 border-b pb-2 dark:border-gray-600" data-translate-key="hub_current_admins">Current Admins</h5>
                            <div id="existing-admins-list" class="space-y-3"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
     <div id="edit-doctor-modal" class="modal-overlay">
        <div class="modal-content dark:bg-gray-800 w-full max-w-2xl">
            <div class="flex justify-between items-center mb-6">
                <h4 class="text-2xl font-bold" data-translate-key="edit_doctor_title">Edit Doctor Profile</h4>
                <button class="close-modal-btn font-bold text-3xl leading-none" aria-label="Close modal">×</button>
            </div>
            <form id="edit-doctor-form" class="space-y-4"></form>
        </div>
    </div>
    
    <div id="symptom-checker-modal" class="modal-overlay">
        <div class="modal-content dark:bg-gray-800 w-full max-w-2xl flex flex-col max-h-[90vh]">
            <div class="flex justify-between items-center mb-4 flex-shrink-0">
                <h4 class="text-2xl font-bold" data-translate-key="symptom_title">AI Symptom Checker</h4>
                <button class="close-modal-btn font-bold text-3xl leading-none" aria-label="Close modal">×</button>
            </div>

            <div class="overflow-y-auto -mr-4 pr-4">
                <p class="text-center text-gray-600 dark:text-gray-400 mb-6" data-translate-key="symptom_desc">Describe your symptoms to get an initial analysis. This tool does not provide medical advice.</p>
                <form id="symptom-checker-form" class="space-y-4 mb-6">
                    <div>
                        <label for="symptoms-input" class="block text-gray-700 dark:text-gray-300 font-bold mb-2" data-translate-key="symptom_label">Describe your symptoms:</label>
                        <textarea id="symptoms-input" rows="5" class="shadow-sm appearance-none border rounded-lg w-full py-3 px-4 text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-900 leading-tight focus:outline-none focus:ring-2 dark:border-gray-600" data-translate-key="symptom_placeholder" placeholder="e.g., I have a high fever, a splitting headache, and muscle aches all over my body." required></textarea>
                    </div>
                    <button type="submit" id="check-symptoms-btn" class="w-full bg-green-600 text-white font-semibold py-3 rounded-full shadow-lg hover:bg-green-700 transition duration-300 pro-button" data-translate-key="symptom_analyze_btn">Analyze Symptoms</button>
                </form>
                
                <div id="symptom-loading" class="text-center p-4 hidden">
                    <svg class="animate-spin h-8 w-8 text-green-600 dark:text-green-400 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <p class="mt-2 text-gray-600 dark:text-gray-400" data-translate-key="symptom_loading">Analyzing symptoms...</p>
                </div>

                <div id="symptom-results-container" class="space-y-4 hidden">
                </div>
                 <p id="symptom-disclaimer" class="mt-4 text-sm text-gray-500 italic hidden"><strong data-translate-key="symptom_disclaimer_title">Disclaimer:</strong> <span data-translate-key="symptom_disclaimer_text">This is for informational purposes only and is not a substitute for professional medical advice. Consult a doctor for a proper diagnosis.</span></p>
            </div>
        </div>
    </div>
    
    <!-- Custom Confirmation Modal -->
    <div id="confirmation-modal" class="modal-overlay">
        <div class="modal-content dark:bg-gray-800 text-center w-full max-w-sm">
            <h4 id="confirmation-title" class="text-xl font-bold mb-4">Are you sure?</h4>
            <p id="confirmation-text" class="text-gray-600 dark:text-gray-400 mb-6"></p>
            <div class="flex justify-center space-x-4">
                <button id="confirm-cancel-btn" class="bg-gray-200 text-gray-800 dark:bg-gray-600 dark:text-gray-200 font-semibold py-2 px-6 rounded-full hover:bg-gray-300 dark:hover:bg-gray-500 transition pro-button" data-translate-key="confirm_cancel">Cancel</button>
                <button id="confirm-action-btn" class="bg-red-600 text-white font-semibold py-2 px-6 rounded-full shadow-lg hover:bg-red-700 transition pro-button" data-translate-key="confirm_confirm">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Contact Modal -->
    <div id="contact-modal" class="modal-overlay">
        <div class="modal-content dark:bg-gray-800 w-full max-w-2xl">
            <div id="contact-view">
                <div class="flex justify-between items-center mb-6">
                    <h4 class="text-2xl font-bold flex items-center gap-3">
                        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-green-500"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>
                        <span data-translate-key="contact_title">Get In Touch</span>
                    </h4>
                    <button class="close-modal-btn font-bold text-3xl leading-none" aria-label="Close modal">×</button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div id="contact-form-container">
                        <p class="text-gray-600 dark:text-gray-400 mb-4" data-translate-key="contact_desc">Have a question or want to partner with us? Fill out the form below and we'll get back to you shortly.</p>
                        <form id="contact-form" class="space-y-4">
                            <div>
                                <label for="contact-name" class="block text-sm font-medium text-gray-700 dark:text-gray-300" data-translate-key="auth_full_name">Full Name</label>
                                <input type="text" id="contact-name" name="from_name" class="mt-1 w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-2 dark:bg-gray-900" required>
                            </div>
                             <div>
                                <label for="contact-email" class="block text-sm font-medium text-gray-700 dark:text-gray-300" data-translate-key="auth_email">Email Address</label>
                                <input type="email" id="contact-email" name="from_email" class="mt-1 w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-2 dark:bg-gray-900" required>
                            </div>
                             <div>
                                <label for="contact-message" class="block text-sm font-medium text-gray-700 dark:text-gray-300" data-translate-key="contact_message">Message</label>
                                <textarea id="contact-message" name="message" rows="4" class="mt-1 w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-2 dark:bg-gray-900" required></textarea>
                            </div>
                            <div class="text-right">
                               <button type="submit" class="bg-green-600 text-white font-semibold py-2 px-6 rounded-full shadow-lg hover:bg-green-700 transition duration-300 pro-button">
                                   <span class="button-text" data-translate-key="contact_send_btn">Send Message</span>
                                   <span class="button-loader hidden"><svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></span>
                               </button>
                            </div>
                        </form>
                    </div>
                    <div class="bg-green-50 dark:bg-green-900/40 p-6 rounded-lg border border-green-200 dark:border-green-800 flex flex-col justify-between">
                        <div>
                             <h5 class="text-lg font-bold text-green-800 dark:text-green-300 mb-4" data-translate-key="contact_info">Contact Information</h5>
                             <ul class="space-y-3 text-gray-700 dark:text-gray-300">
                                 <li class="flex items-center gap-3">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-600 dark:text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" /></svg>
                                     <a href="mailto:support@ruralhealthcare.com" class="hover:underline">support@ruralhealthcare.com</a>
                                 </li>
                                  <li class="flex items-center gap-3">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-600 dark:text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" /></svg>
                                     <span>+91-9876543210</span>
                                 </li>
                             </ul>
                        </div>
                         <div>
                            <h5 class="text-lg font-bold text-green-800 dark:text-green-300 mt-6 mb-2" data-translate-key="contact_follow">Follow Us</h5>
                            <div class="flex space-x-4">
                                <a href="#" class="text-gray-500 hover:text-green-600 dark:text-gray-400 dark:hover:text-white"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2.04c-5.5 0-10 4.49-10 10.02 0 5 3.66 9.15 8.44 9.9v-7H7.9v-2.9h2.54V9.84c0-2.5 1.49-3.89 3.78-3.89 1.09 0 2.23.19 2.23.19v2.47h-1.26c-1.24 0-1.63.77-1.63 1.56v1.88h2.78l-.45 2.9h-2.33v7a10 10 0 0 0 8.44-9.9C22 6.53 17.5 2.04 12 2.04z"/></svg></a>
                                <a href="#" class="text-gray-500 hover:text-green-600 dark:text-gray-400 dark:hover:text-white"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M22.46 6c-.77.35-1.6.58-2.46.67.88-.53 1.56-1.37 1.88-2.38-.83.49-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98-3.56-.18-6.73-1.89-8.84-4.48-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.22-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.52 8.52 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.5 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"/></svg></a>
                                <a href="#" class="text-gray-500 hover:text-green-600 dark:text-gray-400 dark:hover:text-white"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.63 15.34c-.49.2-1.75.87-3.43.48-.13-.03-.25-.09-.37-.15-1.56-.8-2.6-2.16-2.69-2.31-.08-.14-.16-.29-.16-.48s.16-.36.31-.51c.13-.13.28-.15.4-.15s.28.03.4.15l.38.38c.11.11.23.23.37.15.17-.09.84-.42 1.54-1.08.79-.75 1.13-1.59.81-1.98-.31-.38-.72-.45-.99-.45-.19 0-.38.01-.56.01-.2 0-.47 0-.7.42-.23.4-.87 1.48-.87 2.91s.95 2.71 1.08 2.89c.13.18 1.81 2.9 4.41 3.86 2.14.79 2.78.71 3.28.42.5-.29.83-1.2.96-2.32.13-1.12.07-2.07-.05-2.22-.12-.15-.28-.23-.51-.23-.24 0-.49.1-.61.2z"/></svg></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="contact-success-message" class="hidden text-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-green-500 mx-auto mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <h4 class="text-2xl font-bold" data-translate-key="contact_success_title">Message Sent!</h4>
                <p class="text-gray-600 dark:text-gray-400 mt-2" data-translate-key="contact_success_desc">Thank you for reaching out. We will get back to you as soon as possible.</p>
            </div>
        </div>
    </div>


    <!-- Chat Widget -->
    <div id="chat-widget-container">
        <div id="chat-window" class="bg-white dark:bg-gray-800">
            <div class="p-4 bg-green-600 text-white font-semibold flex justify-between items-center">
                <h3 class="text-lg">Live Support</h3>
                 <button id="close-chat-btn" class="text-white font-bold text-2xl leading-none" aria-label="Close chat">×</button>
            </div>
            <div id="chat-messages" class="flex-1 p-4 space-y-4 overflow-y-auto flex flex-col">
            </div>
            <form id="chat-form" class="p-4 border-t dark:border-gray-700 flex items-center">
                <input type="text" id="chat-input" placeholder="Type your message..." class="w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm p-2 dark:bg-gray-700">
                <button type="submit" class="ml-2 bg-green-600 text-white p-2 rounded-full" aria-label="Send message">
                     <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                         <path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z" />
                     </svg>
                </button>
            </form>
        </div>
        <button id="chat-toggle-btn" aria-label="Toggle chat">
             <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 20 20" fill="currentColor">
                 <path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.083-3.083A7.002 7.002 0 012 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM4.76 12.364a.75.75 0 001.06 1.06l1.06-1.06a.75.75 0 00-1.06-1.06l-1.06 1.06zM9.24 9.54a.75.75 0 00-1.06-1.06L7.12 9.54a.75.75 0 001.06 1.06l1.06-1.06z" clip-rule="evenodd" />
             </svg>
        </button>
    </div>

    <!-- Main Application Logic -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- 1. SUPABASE & EMAILJS INITIALIZATION ---
            // IMPORTANT: In a real production environment, these keys should be stored in
            // environment variables, not directly in the code, for security reasons.
            const supabaseUrl = 'https://xsemvhghjtorwaiewdbi.supabase.co'; // Your Supabase Project URL
            const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhzZW12aGdoanRvcndhaWV3ZGJpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc1ODk5ODQsImV4cCI6MjA3MzE2NTk4NH0.2CTt5M26WaQBCQAsNJMs7FVaDtGSvbxYbv4E2EE1GwQ'; // Your Supabase Anon Key
            const _supabase = supabase.createClient(supabaseUrl, supabaseKey);
            
            // --- EMAILJS CONFIGURATION ---
            // IMPORTANT: Replace these placeholder values with your actual credentials from your EmailJS account dashboard.
            // The form will not work until you do this.
            // 1. Go to https://www.emailjs.com/ and create a free account.
            // 2. Add a new service (e.g., Gmail) to get your Service ID.
            // 3. Create an email template to get your Template ID.
            // 4. Find your Public Key in the Account > API Keys section.
            const EMAILJS_PUBLIC_KEY = 'user_xxxxxxxxxxxxxxxx';   // Replace with your Public Key
            const EMAILJS_SERVICE_ID = 'service_xxxxxxx';      // Replace with your Service ID
            const EMAILJS_TEMPLATE_ID = 'template_xxxxxxx';      // Replace with your Template ID
            
            // --- 2. GLOBAL STATE ---
            let currentUser = null;
            let confirmAction = null;
            let allDoctors = []; // To store the full list of doctors for filtering

            // --- 3. UTILITY & HELPER FUNCTIONS ---

            // Professional Toast Notification System
            const showToast = (message, type = 'info') => {
                const toastContainer = document.getElementById('toast-container');
                const toast = document.createElement('div');
                toast.className = `toast toast-${type}`;
                toast.textContent = message;
                toastContainer.appendChild(toast);

                setTimeout(() => toast.classList.add('show'), 10);
                setTimeout(() => {
                    toast.classList.remove('show');
                    toast.addEventListener('transitionend', () => toast.remove());
                }, 4000);
            };

            // Toggle loading state on buttons
            const toggleButtonLoading = (button, isLoading) => {
                if(!button) return;
                button.disabled = isLoading;
                const text = button.querySelector('.button-text');
                const loader = button.querySelector('.button-loader');
                if (text) text.classList.toggle('hidden', isLoading);
                if (loader) loader.classList.toggle('hidden', !isLoading);
            };

            // Get age from Date of Birth string
            const getAge = (dateString) => {
                if (!dateString) return '';
                const today = new Date();
                const birthDate = new Date(dateString);
                let age = today.getFullYear() - birthDate.getFullYear();
                const m = today.getMonth() - birthDate.getMonth();
                if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
                    age--;
                }
                return age;
            }
            
            // --- 4. UI INITIALIZATION & EVENT LISTENERS (Non-Modal) ---
            
            // Theme Toggle
            const themeToggleBtn = document.getElementById('theme-toggle');
            const darkIcon = document.getElementById('theme-toggle-dark-icon');
            const lightIcon = document.getElementById('theme-toggle-light-icon');
            if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark');
                lightIcon.classList.remove('hidden');
            } else {
                document.documentElement.classList.remove('dark');
                darkIcon.classList.remove('hidden');
            }
            themeToggleBtn.addEventListener('click', () => {
                darkIcon.classList.toggle('hidden');
                lightIcon.classList.toggle('hidden');
                const isDark = document.documentElement.classList.toggle('dark');
                localStorage.setItem('color-theme', isDark ? 'dark' : 'light');
            });

            // Mobile Menu Toggle
            const menuToggle = document.getElementById('menu-toggle');
            const navLinks = document.getElementById('nav-links');
            menuToggle.addEventListener('click', () => {
                navLinks.classList.toggle('active');
                menuToggle.setAttribute('aria-expanded', navLinks.classList.contains('active'));
            });

            // Services Dropdown Menu
            const servicesDropdownToggle = document.getElementById('services-dropdown-toggle');
            const servicesDropdownMenu = document.getElementById('services-dropdown-menu');
            const servicesDropdownArrow = servicesDropdownToggle.querySelector('svg');
            servicesDropdownToggle.addEventListener('click', (e) => {
                e.stopPropagation();
                const isHidden = servicesDropdownMenu.classList.toggle('hidden');
                servicesDropdownArrow.classList.toggle('rotate-180', !isHidden);
            });
            window.addEventListener('click', (e) => {
                if (!servicesDropdownMenu.classList.contains('hidden') && !e.target.closest('#services-dropdown-container')) {
                    servicesDropdownMenu.classList.add('hidden');
                    servicesDropdownArrow.classList.remove('rotate-180');
                }
            });

            // New Page View Logic
            const learnMoreBtn = document.getElementById('learn-more-btn');
            const goBackBtn = document.getElementById('go-back-btn');
            const mainContentContainer = document.getElementById('main-content-container');
            const learnMorePage = document.getElementById('learn-more-page');

            const showMainContent = () => {
                learnMorePage.classList.add('hidden');
                mainContentContainer.classList.remove('hidden');
            };

            learnMoreBtn.addEventListener('click', () => {
                mainContentContainer.classList.add('hidden');
                learnMorePage.classList.remove('hidden');
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });

            goBackBtn.addEventListener('click', showMainContent);
            
            // Smooth Scrolling & Menu Closing for Nav Links
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    if (link.getAttribute('href') !== '#contact') {
                        showMainContent(); 
                    }
                    if (link.classList.contains('dropdown-link')) {
                        servicesDropdownMenu.classList.add('hidden');
                        servicesDropdownArrow.classList.remove('rotate-180');
                    }
                    if (navLinks.classList.contains('active')) {
                        navLinks.classList.remove('active');
                        menuToggle.setAttribute('aria-expanded', 'false');
                    }
                });
            });

            // --- UPDATED: Scroll Animations ---
            const animationObserver = new IntersectionObserver((entries) => {
                entries.forEach((entry) => {
                    if (entry.isIntersecting) {
                        // Apply a slight random delay for a more natural staggered effect
                        const delay = entry.target.classList.contains('feature-card') ? (Math.random() * 400) : 0;
                        setTimeout(() => {
                            entry.target.classList.add('is-visible');
                        }, delay);
                        animationObserver.unobserve(entry.target);
                    }
                });
            }, { rootMargin: '0px 0px -100px 0px' });

            // Observe all initial animated elements
            document.querySelectorAll('.feature-card, .section-title-animate').forEach(el => animationObserver.observe(el));
            
            // Navbar Shadow on Scroll
            const header = document.getElementById('main-header');
            window.addEventListener('scroll', () => {
                header.classList.toggle('scrolled', window.scrollY > 10);
            });

            // --- 5. MODAL HANDLING ---

            const allModals = document.querySelectorAll('.modal-overlay');
            const openModal = (modal) => {
                modal.classList.add('active');
                document.body.style.overflow = 'hidden';
            };
            const closeModal = (modal) => {
                modal.classList.remove('active');
                document.body.style.overflow = '';
            };
            const closeAllModals = () => {
                 allModals.forEach(closeModal);
            }

            allModals.forEach(modal => {
                modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(modal); });
                modal.querySelectorAll('.close-modal-btn').forEach(btn => btn.addEventListener('click', () => closeModal(modal)));
            });

             // Close modal on escape key press
            document.addEventListener('keydown', (e) => {
                if (e.key === "Escape") {
                    const activeModal = document.querySelector('.modal-overlay.active');
                    if (activeModal) {
                        closeModal(activeModal);
                    }
                }
            });

            // Custom Confirmation Modal Logic
            const confirmationModal = document.getElementById('confirmation-modal');
            const confirmActionBtn = document.getElementById('confirm-action-btn');
            const confirmCancelBtn = document.getElementById('confirm-cancel-btn');
            
            const showConfirmationModal = (text, title = "Are you sure?") => {
                document.getElementById('confirmation-title').textContent = title;
                document.getElementById('confirmation-text').textContent = text;
                openModal(confirmationModal);
                return new Promise(resolve => {
                    confirmAction = resolve;
                });
            };
            
            confirmActionBtn.addEventListener('click', () => {
                if (confirmAction) confirmAction(true);
                closeModal(confirmationModal);
            });
            
            confirmCancelBtn.addEventListener('click', () => {
                if (confirmAction) confirmAction(false);
                closeModal(confirmationModal);
            });

            // --- 6. FEATURE-SPECIFIC LOGIC & MODALS ---

            // --- Feature Modals Logic ---
            const featureModal = document.getElementById('feature-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalText = document.getElementById('modal-text');
            const telemedicineModal = document.getElementById('telemedicine-modal');
            const recordsManagementModal = document.getElementById('records-management-modal');
            const patientDetailModal = document.getElementById('patient-detail-modal');
            const symptomCheckerModal = document.getElementById('symptom-checker-modal');
            const medicalHubDashboardModal = document.getElementById('medical-hub-dashboard-modal');
            const loginRegisterModal = document.getElementById('login-register-modal');
            const medicineTrackerModal = document.getElementById('medicine-tracker-modal');
            const scalableModelModal = document.getElementById('scalable-model-modal');
            const contactModal = document.getElementById('contact-modal');
            
            document.querySelectorAll('.explore-btn').forEach(btn => {
                btn.addEventListener('click', async () => {
                    const feature = btn.dataset.feature;
                    switch(feature) {
                        case 'Telemedicine': 
                            if (!currentUser) {
                                showToast("Please log in to start a consultation.", "info");
                                openModal(loginRegisterModal);
                                return;
                            }
                            openModal(telemedicineModal); 
                            break;
                        case 'Health Records': 
                             if (!currentUser) {
                                 showToast("Please log in to access health records.", "info");
                                 openModal(loginRegisterModal);
                                 return;
                             }
                             if (currentUser.role === 'doctor') {
                                 showRecordsForDoctor();
                             } else if (currentUser.role === 'patient') {
                                 document.getElementById('my-record-btn').click();
                             } else {
                                 showToast("Health records are available for patients and doctors.", "info");
                             }
                            break;
                        case 'Medicine Tracker': 
                            if (!currentUser) {
                                showToast("Please log in to use this feature.", "info");
                                openModal(loginRegisterModal);
                                return;
                            }
                            openModal(medicineTrackerModal);
                            break;
                        case 'Symptom Checker': openModal(symptomCheckerModal); break;
                        case 'Scalable Model': openModal(scalableModelModal); break;
                        default:
                            modalTitle.textContent = `💡 ${feature}`;
                            modalText.textContent = 'More information and resources about this feature are coming soon.';
                            openModal(featureModal);
                    }
                });
            });

            // Contact Modal Logic
            document.querySelectorAll('a[href="#contact"]').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    closeAllModals();
                    document.getElementById('contact-form').reset();
                    document.getElementById('contact-view').style.display = 'block';
                    document.getElementById('contact-form-container').classList.remove('hidden');
                    document.getElementById('contact-success-message').classList.add('hidden');
                    openModal(contactModal);
                });
            });

            const contactForm = document.getElementById('contact-form');
            contactForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const submitBtn = e.target.querySelector('button[type="submit"]');

                if (EMAILJS_PUBLIC_KEY === 'user_xxxxxxxxxxxxxxxx' || EMAILJS_SERVICE_ID === 'service_xxxxxxx' || EMAILJS_TEMPLATE_ID === 'template_xxxxxxx') {
                    showToast("Contact form is not configured by the website owner.", "error");
                    console.error("EmailJS credentials are placeholders. Please replace them in the script to enable the contact form.");
                    return;
                }

                toggleButtonLoading(submitBtn, true);

                emailjs.sendForm(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, e.target)
                    .then((response) => {
                        console.log('SUCCESS!', response.status, response.text);
                        showToast("Your message has been sent successfully!", "success");
                        document.getElementById('contact-form-container').classList.add('hidden');
                        document.getElementById('contact-success-message').classList.remove('hidden');
                        contactForm.reset();
                    }, (error) => {
                        console.log('FAILED...', error);
                        showToast("Failed to send message. Please try again later.", "error");
                    })
                    .finally(() => {
                        toggleButtonLoading(submitBtn, false);
                    });
            });
            
            document.getElementById('my-record-btn').addEventListener('click', async () => {
                if(!currentUser) return;
                 const { data: patient, error } = await _supabase.from('patients').select('*').eq('user_id', currentUser.id).single();
                if(error || !patient) {
                    showToast("No health record has been linked to your account yet.", "info");
                    return;
                }
                showPatientReport(patient);
            });

            document.getElementById('admin-dashboard-btn').addEventListener('click', () => {
                 openModal(medicalHubDashboardModal);
                 showHubTab('doctors');
               });

            // --- Telemedicine Jitsi Logic ---
            const connectForm = document.getElementById('connect-form');
            let jitsiApi = null;
            connectForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const patientNameInput = document.getElementById('patient-name');
                const meetingId = document.getElementById('jitsi-meeting-id').value.trim();
                const formError = document.getElementById('form-error');

                if (currentUser) {
                    patientNameInput.value = currentUser.full_name;
                }
                const patientName = patientNameInput.value.trim();

                if (!patientName || !meetingId) {
                    formError.classList.remove('hidden'); return;
                }
                formError.classList.add('hidden');
                if (jitsiApi) jitsiApi.dispose();
                
                const jitsiContainer = document.getElementById('jitsi-container');
                const options = {
                    roomName: meetingId, width: '100%', height: '100%', parentNode: jitsiContainer,
                    userInfo: { displayName: patientName },
                    iframeAttributes: { allow: "camera; microphone; fullscreen; display-capture; autoplay" },
                    configOverwrite: { prejoinPageEnabled: false },
                };
                jitsiContainer.classList.remove('hidden');
                jitsiApi = new JitsiMeetExternalAPI('meet.jit.si', options);
                jitsiApi.addEventListener('videoConferenceLeft', () => {
                    jitsiApi.dispose(); jitsiApi = null;
                    jitsiContainer.classList.add('hidden');
                    jitsiContainer.innerHTML = '';
                });
            });

            // --- Health Record Logic ---
            const addPatientForm = document.getElementById('add-patient-form');
            const patientListContainer = document.getElementById('patient-list-container');
            const recordPreviewModal = document.getElementById('record-preview-modal');
            const modalRecordContent = document.getElementById('modal-record-content');
            const addPatientColumn = document.getElementById('add-patient-column');

            const showRecordsForDoctor = () => {
                addPatientColumn.classList.remove('hidden');
                renderPatientListForDoctor();
                openModal(recordsManagementModal);
            };

            const renderPatientListForDoctor = async () => {
                patientListContainer.innerHTML = `<p class="text-gray-500">Loading patients...</p>`;
                const { data: patients, error } = await _supabase
                    .from('patients')
                    .select('*')
                    .eq('doctor_id', currentUser.id);

                if (error) {
                    patientListContainer.innerHTML = `<p class="text-red-500">Error fetching patients.</p>`;
                    console.error(error);
                    return;
                }

                patientListContainer.innerHTML = '';
                if (patients.length === 0) {
                    patientListContainer.innerHTML = `<p class="text-gray-500 text-center">No patients added yet.</p>`;
                    return;
                }

                patients.forEach(patient => {
                    const patientEl = document.createElement('div');
                    patientEl.className = 'flex justify-between items-center bg-white dark:bg-gray-700 p-3 rounded-lg border dark:border-gray-600';
                    patientEl.innerHTML = `
                        <div>
                            <p class="font-semibold">${patient.name}</p>
                            <p class="text-sm text-gray-500 dark:text-gray-400">Age: ${getAge(patient.dob)}, ${patient.gender}</p>
                        </div>
                        <button class="manage-patient-btn bg-blue-500 text-white text-sm font-semibold py-1 px-3 rounded-full hover:bg-blue-600 transition" data-patient-id="${patient.id}">Manage</button>
                    `;
                    patientListContainer.appendChild(patientEl);
                });
            };
            
            addPatientForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const submitBtn = e.target.querySelector('button[type="submit"]');
                toggleButtonLoading(submitBtn, true);

                const patientEmail = document.getElementById('patient-user-email').value.trim();
                let patientUserId = null;

                if (patientEmail) {
                    const { data: userProfile } = await _supabase.from('profiles').select('id').eq('email', patientEmail).single();
                    if (userProfile) {
                        patientUserId = userProfile.id;
                    } else {
                        showToast("No registered user found with that email. Patient will be created without an account link.", "info");
                    }
                }

                const newPatient = {
                    name: document.getElementById('new-patient-name').value,
                    dob: document.getElementById('new-patient-dob').value,
                    gender: document.getElementById('new-patient-gender').value,
                    doctor_id: currentUser.id,
                    user_id: patientUserId
                };

                const { error } = await _supabase.from('patients').insert(newPatient);

                if (error) {
                    showToast('Error adding patient: ' + error.message, 'error');
                } else {
                    showToast('Patient added successfully!', 'success');
                    await renderPatientListForDoctor();
                    addPatientForm.reset();
                }
                toggleButtonLoading(submitBtn, false);
            });

            const openPatientDetailView = async (patientId) => {
                const { data: patient, error } = await _supabase.from('patients').select('*').eq('id', patientId).single();
                if (error || !patient) {
                    showToast('Could not fetch patient details.', 'error');
                    return;
                }

                document.getElementById('detail-patient-name').textContent = patient.name;
                document.getElementById('detail-patient-info').textContent = `DOB: ${patient.dob} (Age: ${getAge(patient.dob)}), Gender: ${patient.gender}`;
                document.getElementById('consultation-patient-id').value = patient.id;
                document.getElementById('add-consultation-form').reset();
                
                await renderConsultationsForPatient(patient.id);

                document.getElementById('generate-report-btn').onclick = () => showPatientReport(patient);

                openModal(patientDetailModal);
            };

            const renderConsultationsForPatient = async (patientId) => {
                const container = document.getElementById('consultation-list-container');
                container.innerHTML = `<p class="text-gray-500">Loading consultations...</p>`;
                
                const { data: consultations, error } = await _supabase
                    .from('consultations')
                    .select(`*, doctor:doctor_id(full_name)`)
                    .eq('patient_id', patientId)
                    .order('created_at', { ascending: false });

                if (error) {
                    container.innerHTML = `<p class="text-red-500">Error fetching consultations.</p>`;
                    return;
                }
                
                container.innerHTML = '';
                if (consultations.length === 0) {
                     container.innerHTML = `<p class="text-gray-500 text-center">No consultations recorded yet.</p>`;
                     return;
                }

                consultations.forEach(c => {
                    const el = document.createElement('div');
                    el.className = 'bg-white dark:bg-gray-700/50 p-4 rounded-lg border dark:border-gray-600';
                    el.innerHTML = `
                        <div class="flex justify-between items-center mb-2">
                            <h6 class="font-bold text-gray-800 dark:text-gray-200">Consultation on ${new Date(c.created_at).toLocaleDateString()}</h6>
                            <p class="text-sm text-gray-500 dark:text-gray-400">Dr. ${c.doctor.full_name}</p>
                        </div>
                        <div class="text-sm space-y-2">
                            <p><strong>Symptoms:</strong> ${c.symptoms}</p>
                            <p><strong>Diagnosis:</strong> ${c.diagnosis}</p>
                            ${c.prescription ? `<p><strong>Prescription:</strong> ${c.prescription}</p>` : ''}
                            ${c.notes ? `<p><strong>Notes:</strong> ${c.notes}</p>` : ''}
                        </div>
                    `;
                    container.appendChild(el);
                });
            };

            document.getElementById('add-consultation-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                const submitBtn = e.target.querySelector('button[type="submit"]');
                toggleButtonLoading(submitBtn, true);

                const patientId = document.getElementById('consultation-patient-id').value;
                const newConsultation = {
                    patient_id: patientId,
                    doctor_id: currentUser.id,
                    symptoms: document.getElementById('consultation-symptoms').value,
                    diagnosis: document.getElementById('consultation-diagnosis').value,
                    prescription: document.getElementById('consultation-prescription').value,
                    notes: document.getElementById('consultation-notes').value,
                };
                
                const { error } = await _supabase.from('consultations').insert(newConsultation);
                if (error) {
                    showToast('Failed to save consultation: ' + error.message, 'error');
                } else {
                    showToast('Consultation saved!', 'success');
                    await renderConsultationsForPatient(patientId);
                    e.target.reset();
                }
                toggleButtonLoading(submitBtn, false);
            });
            
            const showPatientReport = async (patient) => {
                const { data: consultations, error: consultError } = await _supabase
                    .from('consultations')
                    .select('*')
                    .eq('patient_id', patient.id)
                    .order('created_at', { ascending: false });

                if (consultError) {
                    showToast('Could not fetch consultation records.', 'error');
                    return;
                }

                let doctorsMap = {};
                if (consultations.length > 0) {
                    const doctorIds = [...new Set(consultations.map(c => c.doctor_id))];
                    const { data: doctors, error: doctorError } = await _supabase
                        .from('profiles')
                        .select('id, full_name')
                        .in('id', doctorIds);

                    if (!doctorError) {
                        doctors.forEach(d => { doctorsMap[d.id] = d.full_name; });
                    }
                }

                let reportContent = `
    RURAL HEALTHCARE - PATIENT REPORT
    -----------------------------------
    Patient Name: ${patient.name}
    Patient ID:   RHC-PAT-${patient.id}
    DOB:          ${patient.dob} (Age: ${getAge(patient.dob)})
    Gender:       ${patient.gender}
    Report Date:  ${new Date().toLocaleString()}
    -----------------------------------`;

                if (consultations.length > 0) {
                    consultations.forEach(c => {
                        const doctorName = doctorsMap[c.doctor_id] || 'N/A';
                        reportContent += `
    \n
    CONSULTATION DATE: ${new Date(c.created_at).toLocaleString()}
    Consulting Doctor: Dr. ${doctorName}

    SYMPTOMS:
    ${c.symptoms || 'N/A'}

    DIAGNOSIS:
    ${c.diagnosis || 'N/A'}

    PRESCRIPTION:
    ${c.prescription || 'N/A'}

    NOTES:
    ${c.notes || 'N/A'}
    -----------------------------------`;
                    });
                } else {
                    reportContent += `\n\nNo consultation records found for this patient.`;
                }

                modalRecordContent.textContent = reportContent.trim();
                document.getElementById('print-record-btn').dataset.report = reportContent;
                document.getElementById('download-record-btn').dataset.report = reportContent;
                document.getElementById('download-record-btn').dataset.name = patient.name;
                openModal(recordPreviewModal);
            };

            patientListContainer.addEventListener('click', (e) => {
                if (e.target.classList.contains('manage-patient-btn')) {
                    openPatientDetailView(e.target.dataset.patientId);
                }
            });

            document.getElementById('download-record-btn').addEventListener('click', (e) => {
                const content = e.target.dataset.report;
                const patientName = e.target.dataset.name;
                const blob = new Blob([content], { type: 'text/plain' });
                const a = document.createElement('a');
                a.href = URL.createObjectURL(blob);
                a.download = `Patient-Record-${patientName.replace(/\s+/g, '_')}.txt`;
                a.click();
                URL.revokeObjectURL(a.href);
            });

            document.getElementById('print-record-btn').addEventListener('click', (e) => {
                const content = e.target.dataset.report;
                const printWindow = window.open('', '_blank');
                printWindow.document.write('<pre style="font-family: monospace; font-size: 14px;">' + content + '</pre>');
                printWindow.document.close();
                printWindow.focus();
                printWindow.print();
                printWindow.close();
            });
            
            // --- Medicine Tracker & Pharmacy Logic ---
            document.getElementById('medicine-search-form').addEventListener('submit', async e => {
                e.preventDefault();
                const query = document.getElementById('medicine-search-input').value.trim();
                const resultsContainer = document.getElementById('medicine-results-container');
                const spinner = document.getElementById('loading-spinner');
                const noResults = document.getElementById('no-results-message');
                
                resultsContainer.innerHTML = '';
                spinner.classList.remove('hidden');
                noResults.classList.add('hidden');

                const { data, error } = await _supabase
                    .from('inventory')
                    .select(`*, stores (*)` )
                    .ilike('medicine_name', `%${query}%`);
                
                spinner.classList.add('hidden');
                
                if (error || data.length === 0) {
                     noResults.classList.remove('hidden');
                } else {
                     data.forEach(item => {
                         const resultEl = document.createElement('div');
                         resultEl.className = 'bg-white dark:bg-gray-700/50 p-4 rounded-lg border dark:border-gray-600';
                         const inStock = item.stock > 0;
                         const stockStatus = inStock ? `<span class="font-bold text-green-600 dark:text-green-400">In Stock (${item.stock} units)</span>` : `<span class="font-bold text-red-600 dark:text-red-400">Out of Stock</span>`;
                         resultEl.innerHTML = `
                             <div class="flex justify-between items-start">
                                 <div>
                                     <p class="font-semibold text-lg">${item.medicine_name}</p>
                                     <p class="text-gray-800 dark:text-gray-300 font-medium">${item.stores.name}</p>
                                     <div class="flex items-center mt-1">
                                         <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1 text-gray-400" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd" /></svg>
                                         <a href="${item.stores.google_maps_url}" target="_blank" class="text-xs text-blue-600 dark:text-blue-400 hover:underline">${item.stores.address}</a>
                                     </div>
                                 </div>
                                 <div class="text-right flex-shrink-0 ml-4">
                                     <p class="text-sm">${stockStatus}</p>
                                 </div>
                             </div>
                         `;
                         resultsContainer.appendChild(resultEl);
                     });
                }
            });

            // ---- Admin Hub Logics ----
            const hubTabs = document.getElementById('hub-tabs');
            const hubDoctorsView = document.getElementById('hub-doctors-view');
            const hubAdminsView = document.getElementById('hub-admins-view');
            const editDoctorModal = document.getElementById('edit-doctor-modal');

            const showHubTab = (tab) => {
                hubDoctorsView.classList.toggle('hidden', tab !== 'doctors');
                hubAdminsView.classList.toggle('hidden', tab !== 'admins');
                hubTabs.querySelector('.active').classList.remove('active');
                hubTabs.querySelector(`[data-tab="${tab}"]`).classList.add('active');
                 if(tab === 'doctors') renderExistingDoctors();
                 if(tab === 'admins') renderExistingAdmins();
            };
            
            hubTabs.addEventListener('click', e => {
                if (e.target.matches('.hub-tab')) {
                   showHubTab(e.target.dataset.tab);
                }
            });

            // --- Doctors Section Logic ---
            const doctorsContainer = document.getElementById('doctors-container');
            const addDoctorForm = document.getElementById('add-doctor-form');
            const editDoctorForm = document.getElementById('edit-doctor-form');
            const doctorSearchInput = document.getElementById('doctor-search');
            const specializationFilter = document.getElementById('doctor-specialization-filter');
            const noDoctorsFoundMessage = document.getElementById('no-doctors-found');

            const populateSpecializationFilter = () => {
                const specializations = [...new Set(allDoctors.map(doc => doc.specialization).filter(Boolean))];
                specializationFilter.innerHTML = '<option value="">All Specializations</option>';
                specializations.sort().forEach(spec => {
                    const option = document.createElement('option');
                    option.value = spec;
                    option.textContent = spec;
                    specializationFilter.appendChild(option);
                });
            };

            const filterAndRenderDoctors = () => {
                const searchTerm = doctorSearchInput.value.toLowerCase();
                const selectedSpec = specializationFilter.value;

                const filteredDoctors = allDoctors.filter(doctor => {
                    const nameMatch = doctor.full_name.toLowerCase().includes(searchTerm);
                    const specMatch = !selectedSpec || doctor.specialization === selectedSpec;
                    return nameMatch && specMatch;
                });
                
                doctorsContainer.innerHTML = '';
                if (filteredDoctors.length === 0) {
                    noDoctorsFoundMessage.classList.remove('hidden');
                } else {
                    noDoctorsFoundMessage.classList.add('hidden');
                    filteredDoctors.forEach(doctor => {
                        const card = document.createElement('div');
                        card.className = `feature-card bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg text-center`;
                        card.innerHTML = `
                            <img src="${doctor.img_url || `https://placehold.co/150x150/d1fae5/14532d?text=Dr`}" alt="${doctor.full_name}" class="w-32 h-32 rounded-full mx-auto mb-4 border-4 border-green-200 object-cover">
                            <h3 class="text-xl font-bold text-gray-800 dark:text-gray-200">${doctor.full_name}</h3>
                            <p class="text-green-600 dark:text-green-400 font-semibold mb-2">${doctor.specialization || 'General Physician'}</p>
                            <p class="text-gray-600 dark:text-gray-400 text-sm mb-4">${doctor.bio || 'Dedicated to providing the best healthcare.'}</p>
                            <button class="book-appointment-btn bg-green-600 text-white font-semibold py-2 px-6 rounded-full shadow-lg hover:bg-green-700 transition duration-300 pro-button" data-meeting-id="room-${doctor.id.substring(0, 8)}">Book Appointment</button>
                        `;
                        doctorsContainer.appendChild(card);
                        animationObserver.observe(card);
                    });
                }
            };
            
            const fetchAndRenderDoctors = async () => {
                const { data: doctors, error } = await _supabase
                    .from('profiles')
                    .select('*')
                    .eq('role', 'doctor');

                if (error) {
                    doctorsContainer.innerHTML = `<p class="text-red-500 text-center col-span-3">Error fetching doctors.</p>`;
                    return;
                }
                
                allDoctors = doctors;
                populateSpecializationFilter();
                filterAndRenderDoctors();
            };

            doctorSearchInput.addEventListener('input', filterAndRenderDoctors);
            specializationFilter.addEventListener('change', filterAndRenderDoctors);
            
            doctorsContainer.addEventListener('click', (e) => {
                if(e.target.matches('.book-appointment-btn')) {
                    if (!currentUser) {
                        showToast("Please log in to book an appointment.", "info");
                        openModal(loginRegisterModal);
                        return;
                    }
                    const meetingId = e.target.dataset.meetingId;
                    document.getElementById('jitsi-meeting-id').value = meetingId;
                    openModal(telemedicineModal);
                }
            })

            const renderExistingDoctors = async () => {
                const container = document.getElementById('existing-doctors-list');
                 const { data: doctors, error } = await _supabase
                         .from('profiles')
                         .select('*')
                         .eq('role', 'doctor');
                 container.innerHTML = '';
                 if (error || doctors.length === 0) {
                         container.innerHTML = `<p class="text-gray-500 text-center">No doctors registered.</p>`;
                         return;
                 }
                 doctors.forEach(doc => {
                     const docEl = document.createElement('div');
                     docEl.className = 'bg-white dark:bg-gray-700 p-3 rounded-lg border dark:border-gray-600 flex justify-between items-center';
                     docEl.innerHTML = `
                         <div>
                             <p class="font-semibold">${doc.full_name} <span class="text-sm font-normal text-gray-500 dark:text-gray-400">- ${doc.specialization}</span></p>
                             <p class="text-xs text-gray-600 dark:text-gray-400">${doc.license_id}</p>
                         </div>
                         <div class="space-x-2">
                              <button class="edit-doctor-btn text-sm text-blue-500 hover:underline" data-id="${doc.id}">Edit</button>
                              <button class="remove-doctor-btn text-sm text-red-500 hover:underline" data-id="${doc.id}">Remove</button>
                         </div>
                     `;
                     container.appendChild(docEl);
                 });
            };
            
              document.getElementById('existing-doctors-list').addEventListener('click', async e => {
                  const doctorId = e.target.dataset.id;
                  if (!doctorId) return;

                  if (e.target.matches('.edit-doctor-btn')) {
                      const { data: doctor } = await _supabase.from('profiles').select('*').eq('id', doctorId).single();
                      if (doctor) {
                          populateEditDoctorForm(doctor);
                          openModal(editDoctorModal);
                      }
                  }

                  if (e.target.matches('.remove-doctor-btn')) {
                      const confirmed = await showConfirmationModal('This will change their role to a standard patient. Are you sure you want to remove this doctor profile?');
                      if (confirmed) {
                          const { error } = await _supabase.from('profiles').update({ role: 'patient' }).eq('id', doctorId);
                          if (error) {
                              showToast('Error removing doctor: ' + error.message, 'error');
                          } else {
                              renderExistingDoctors();
                              fetchAndRenderDoctors();
                              showToast('Doctor profile removed successfully.', 'success');
                          }
                      }
                  }
              });

            const populateEditDoctorForm = (doctor) => {
                editDoctorForm.innerHTML = `
                    <input type="hidden" id="edit-doctor-id" value="${doctor.id}">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="edit-doctor-name" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Doctor's Full Name</label>
                            <input type="text" id="edit-doctor-name" value="${doctor.full_name || ''}" class="mt-1 w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-2 dark:bg-gray-900" required>
                        </div>
                        <div>
                            <label for="edit-doctor-specialization" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Specialization</label>
                            <input type="text" id="edit-doctor-specialization" value="${doctor.specialization || ''}" class="mt-1 w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-2 dark:bg-gray-900" required>
                        </div>
                         <div>
                            <label for="edit-doctor-license" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Medical License ID</label>
                            <input type="text" id="edit-doctor-license" value="${doctor.license_id || ''}" class="mt-1 w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-2 dark:bg-gray-900" required>
                        </div>
                        <div>
                            <label for="edit-doctor-photo" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Photo URL</label>
                            <input type="url" id="edit-doctor-photo" value="${doctor.img_url || ''}" class="mt-1 w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-2 dark:bg-gray-900" placeholder="https://example.com/photo.jpg">
                        </div>
                    </div>
                    <div>
                        <label for="edit-doctor-bio" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Short Bio</label>
                        <textarea id="edit-doctor-bio" rows="3" class="mt-1 w-full border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-2 dark:bg-gray-900" required>${doctor.bio || ''}</textarea>
                    </div>
                    <div class="text-right">
                        <button type="submit" class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-full shadow-lg hover:bg-blue-700 pro-button">
                            <span class="button-text">Save Changes</span>
                            <span class="button-loader hidden"><svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></span>
                        </button>
                    </div>
                `;
            };

            editDoctorForm.addEventListener('submit', async e => {
                e.preventDefault();
                const submitBtn = e.target.querySelector('button[type="submit"]');
                toggleButtonLoading(submitBtn, true);

                const doctorId = document.getElementById('edit-doctor-id').value;
                const updatedProfile = {
                    full_name: document.getElementById('edit-doctor-name').value,
                    specialization: document.getElementById('edit-doctor-specialization').value,
                    license_id: document.getElementById('edit-doctor-license').value,
                    bio: document.getElementById('edit-doctor-bio').value,
                    img_url: document.getElementById('edit-doctor-photo').value
                };
                
                const { error } = await _supabase.from('profiles').update(updatedProfile).eq('id', doctorId);
                
                if (error) {
                    showToast('Error updating profile: ' + error.message, 'error');
                } else {
                    fetchAndRenderDoctors();
                    renderExistingDoctors();
                    closeModal(editDoctorModal);
                    showToast('Doctor profile updated successfully!', 'success');
                }
                toggleButtonLoading(submitBtn, false);
            });

            addDoctorForm.innerHTML = `<p class="text-sm text-gray-500">Doctor accounts should be created through the main 'Register' form by selecting the 'Doctor' role.</p>`;

            // --- Admin Management Logic ---
            const addAdminForm = document.getElementById('add-admin-form');
            const existingAdminsList = document.getElementById('existing-admins-list');

            const renderExistingAdmins = async () => {
                existingAdminsList.innerHTML = `<p class="text-gray-500">Loading admins...</p>`;
                const { data, error } = await _supabase.from('profiles').select('id, full_name, email').eq('role', 'admin');

                if (error) {
                    existingAdminsList.innerHTML = `<p class="text-red-500">Failed to load admins.</p>`;
                    return;
                }

                existingAdminsList.innerHTML = '';
                data.forEach(admin => {
                    const isAdminCurrentUser = admin.id === currentUser.id;
                    const removeButton = isAdminCurrentUser ? 
                        '<span class="text-sm text-gray-400">Cannot remove self</span>' : 
                        `<button class="remove-admin-btn text-sm text-red-500 hover:underline" data-id="${admin.id}">Remove</button>`;
                    
                    const adminEl = document.createElement('div');
                    adminEl.className = 'bg-white dark:bg-gray-700 p-3 rounded-lg border dark:border-gray-600 flex justify-between items-center';
                    adminEl.innerHTML = `
                        <div>
                            <p class="font-semibold">${admin.full_name}</p>
                            <p class="text-xs text-gray-500 dark:text-gray-400">${admin.email}</p>
                        </div>
                        <div>${removeButton}</div>
                    `;
                    existingAdminsList.appendChild(adminEl);
                });
            };

            addAdminForm.addEventListener('submit', async e => {
                e.preventDefault();
                const submitBtn = e.target.querySelector('button[type="submit"]');
                toggleButtonLoading(submitBtn, true);

                const email = document.getElementById('new-admin-email').value;
                const { data: user, error } = await _supabase.from('profiles').select('id, role').eq('email', email).single();
                
                if (error || !user) {
                    showToast("No user found with this email.", "error");
                } else if (user.role === 'admin') {
                    showToast("This user is already an admin.", "info");
                } else {
                    const { error: updateError } = await _supabase.from('profiles').update({ role: 'admin' }).eq('id', user.id);
                    if (updateError) {
                        showToast('Failed to promote user: ' + updateError.message, 'error');
                    } else {
                        showToast('User promoted to admin!', 'success');
                        renderExistingAdmins();
                        e.target.reset();
                    }
                }
                toggleButtonLoading(submitBtn, false);
            });

            existingAdminsList.addEventListener('click', async e => {
                if (e.target.matches('.remove-admin-btn')) {
                    const confirmed = await showConfirmationModal('Are you sure you want to remove admin privileges from this user? They will be demoted to a patient role.');
                    if (confirmed) {
                        const userId = e.target.dataset.id;
                        const { error } = await _supabase.from('profiles').update({ role: 'patient' }).eq('id', userId);
                        if (error) {
                            showToast('Failed to remove admin: ' + error.message, 'error');
                        } else {
                            showToast('Admin privileges removed.', 'success');
                            renderExistingAdmins();
                        }
                    }
                }
            });

            // --- Symptom Checker Logic ---
            const symptomCheckerForm = document.getElementById('symptom-checker-form');
            const symptomLoading = document.getElementById('symptom-loading');
            const symptomResultsContainer = document.getElementById('symptom-results-container');
            const symptomDisclaimer = document.getElementById('symptom-disclaimer');

            const symptomDatabase = {
                common_cold: { keywords: ["cough", "sore throat", "runny nose", "stuffy nose", "sneezing"], displayName: "Common Cold", description: "A mild viral infection of the nose and throat.", recommendation: "Rest, stay hydrated, and manage symptoms with over-the-counter medications.", severity: "low" },
                influenza: { keywords: ["fever", "chills", "muscle", "body aches", "fatigue", "headache", "cough", "sore throat", "high fever", "splitting headache"], displayName: "Influenza (Flu)", description: "A contagious viral infection causing fever, chills, muscle aches, and fatigue.", recommendation: "Consult a doctor for diagnosis and potential antiviral medication.", severity: "medium" },
                strep_throat: { keywords: ["sore throat", "pain swallowing", "swollen tonsils", "white patches", "fever"], displayName: "Strep Throat", description: "A bacterial infection causing a severe sore throat.", recommendation: "See a doctor for a proper diagnosis (strep test) and antibiotic treatment.", severity: "medium" },
                migraine: { keywords: ["headache", "throbbing", "pounding", "nausea", "sensitivity to light", "sensitivity to sound", "splitting headache"], displayName: "Migraine", description: "A type of headache that can cause severe throbbing pain or a pulsing sensation.", recommendation: "Rest in a dark, quiet room. Consult a doctor for diagnosis and prescription treatment.", severity: "medium" },
                appendicitis: { keywords: ["abdominal pain", "lower right abdomen", "nausea", "vomiting", "loss of appetite", "lower abdomin"], displayName: "Appendicitis", description: "A serious medical condition where the appendix becomes inflamed.", recommendation: "This is a medical emergency. Seek immediate medical attention.", severity: "high" }
            };
            
            const analyzeSymptoms = (text) => {
                const inputText = text.toLowerCase();
                let scores = {};
                for (const condition in symptomDatabase) {
                    scores[condition] = 0;
                    symptomDatabase[condition].keywords.forEach(keyword => {
                        if (inputText.includes(keyword)) scores[condition]++;
                    });
                }
                const sortedConditions = Object.keys(scores).sort((a, b) => scores[b] - scores[a]);
                let results = [];
                for(let i=0; i < 3; i++) {
                    const conditionKey = sortedConditions[i];
                    if(scores[conditionKey] > 0) {
                        const totalKeywords = symptomDatabase[conditionKey].keywords.length;
                        const confidence = Math.min(95, Math.round((scores[conditionKey] / totalKeywords) * 100) + 20);
                        results.push({ ...symptomDatabase[conditionKey], confidence });
                    }
                }
                return results;
            };

            symptomCheckerForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const symptomsText = document.getElementById('symptoms-input').value;
                symptomResultsContainer.innerHTML = '';
                symptomResultsContainer.classList.add('hidden');
                symptomDisclaimer.classList.add('hidden');
                symptomLoading.classList.remove('hidden');

                setTimeout(() => {
                    const results = analyzeSymptoms(symptomsText);
                    symptomLoading.classList.add('hidden');
                    
                    if (results.length > 0) {
                        results.forEach(res => {
                            let severityColor = 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300';
                            if (res.severity === 'low') severityColor = 'bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300';
                            if (res.severity === 'high') severityColor = 'bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300';

                            const resultEl = document.createElement('div');
                            resultEl.className = 'bg-white dark:bg-gray-700/50 p-4 rounded-lg border-l-4';
                            if (res.severity === 'low') resultEl.classList.add('border-green-500');
                            if (res.severity === 'medium') resultEl.classList.add('border-yellow-500');
                            if (res.severity === 'high') resultEl.classList.add('border-red-500');

                            resultEl.innerHTML = `
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="text-lg font-bold text-gray-800 dark:text-gray-200">${res.displayName}</h3>
                                    <span class="text-sm font-semibold px-2 py-1 rounded-full ${severityColor}">${res.confidence}% Confidence</span>
                                </div>
                                <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">${res.description}</p>
                                <div class="bg-gray-50 dark:bg-gray-900/50 p-3 rounded-md">
                                    <h4 class="font-semibold text-sm text-gray-700 dark:text-gray-300 mb-1">Recommendation:</h4>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">${res.recommendation}</p>
                                </div>
                            `;
                            symptomResultsContainer.appendChild(resultEl);
                        });
                    } else {
                         symptomResultsContainer.innerHTML = `<p class="text-center text-gray-600 dark:text-gray-400">Could not determine a likely condition. Please provide more detail or consult a doctor.</p>`;
                    }

                    symptomResultsContainer.classList.remove('hidden');
                    symptomDisclaimer.classList.remove('hidden');

                }, 1500);
            });
            
            // --- 7. AUTHENTICATION & LANGUAGE ---
            const loginForm = document.getElementById('login-form');
            const registerForm = document.getElementById('register-form');
            const authTabs = document.getElementById('auth-tabs');
            const authModalTitle = document.getElementById('auth-modal-title');
            const switchToRegisterBtn = document.getElementById('switch-to-register-btn');
            const switchToLoginBtn = document.getElementById('switch-to-login-btn');
            const doctorIdField = document.getElementById('doctor-id-field');
            const loginRoleInput = document.getElementById('login-role');
            const registerRoleInput = document.getElementById('register-role');
            const registerPasswordInput = document.getElementById('register-password');
            const strengthBar = document.getElementById('password-strength-bar');
            const strengthText = document.getElementById('password-strength-text');

            const updateNavUI = () => {
                const guestView = document.getElementById('guest-session-view');
                const userView = document.getElementById('user-session-view');
                const adminDashboardContainer = document.getElementById('admin-dashboard-btn-container');
                const myRecordContainer = document.getElementById('my-record-btn-container');

                 if (currentUser) {
                     guestView.classList.add('hidden');
                     userView.classList.remove('hidden');
                     document.getElementById('welcome-message').textContent = `Welcome, ${currentUser.full_name}!`;
                    
                     myRecordContainer.classList.toggle('hidden', currentUser.role !== 'patient');
                     adminDashboardContainer.classList.toggle('hidden', currentUser.role !== 'admin');

                 } else {
                     guestView.classList.remove('hidden');
                     userView.classList.add('hidden');
                 }
            };
            
            document.getElementById('login-register-btn').addEventListener('click', () => {
                openModal(loginRegisterModal);
                showLoginForm();
            });

            document.getElementById('logout-btn').addEventListener('click', async () => {
                await _supabase.auth.signOut();
                showToast("You have been logged out.", "info");
            });

            const showLoginForm = () => {
                authModalTitle.textContent = "Login";
                loginForm.classList.remove('hidden');
                registerForm.classList.add('hidden');
            };

            const showRegisterForm = () => {
                authModalTitle.textContent = "Register";
                loginForm.classList.add('hidden');
                registerForm.classList.remove('hidden');
            };

            switchToRegisterBtn.addEventListener('click', showRegisterForm);
            switchToLoginBtn.addEventListener('click', showLoginForm);

            authTabs.addEventListener('click', e => {
                if (e.target.matches('.login-tab')) {
                    const role = e.target.dataset.role;
                    authTabs.querySelector('.active').classList.remove('active');
                    e.target.classList.add('active');
                    loginRoleInput.value = role;
                    registerRoleInput.value = role;
                    doctorIdField.classList.toggle('hidden', role !== 'doctor');
                }
            });

            loginForm.addEventListener('submit', async e => {
                e.preventDefault();
                const submitBtn = e.target.querySelector('button[type="submit"]');
                toggleButtonLoading(submitBtn, true);

                const email = document.getElementById('login-email').value;
                const password = document.getElementById('login-password').value;
                const role = loginRoleInput.value;
                const errorEl = document.getElementById('login-error');
                errorEl.classList.add('hidden');

                const { data, error } = await _supabase.auth.signInWithPassword({ email, password });

                if (error) {
                    errorEl.textContent = error.message;
                    errorEl.classList.remove('hidden');
                } else if (data.user) {
                    const { data: profile } = await _supabase
                        .from('profiles')
                        .select('role')
                        .eq('id', data.user.id)
                        .single();
                    
                    if (profile && profile.role === role) {
                        closeModal(loginRegisterModal);
                        loginForm.reset();
                    } else {
                        await _supabase.auth.signOut();
                        errorEl.textContent = 'Invalid credentials for the selected role.';
                        errorEl.classList.remove('hidden');
                    }
                }
                toggleButtonLoading(submitBtn, false);
            });

            const checkPasswordStrength = (password) => {
                let score = 0;
                if (password.length > 8) score++;
                if (/[A-Z]/.test(password)) score++;
                if (/[a-z]/.test(password)) score++;
                if (/[0-9]/.test(password)) score++;
                if (/[^A-Za-z0-9]/.test(password)) score++;

                strengthBar.className = "password-strength-bar"; // Reset classes
                if (password.length === 0) {
                    strengthText.textContent = '';
                } else if (score < 3) {
                    strengthBar.classList.add('strength-weak');
                    strengthText.textContent = 'Weak';
                } else if (score < 5) {
                    strengthBar.classList.add('strength-medium');
                    strengthText.textContent = 'Medium';
                } else {
                    strengthBar.classList.add('strength-strong');
                    strengthText.textContent = 'Strong';
                }
            };

            registerPasswordInput.addEventListener('input', () => {
                 checkPasswordStrength(registerPasswordInput.value);
            });

            registerForm.addEventListener('submit', async e => {
                e.preventDefault();
                const submitBtn = e.target.querySelector('button[type="submit"]');
                toggleButtonLoading(submitBtn, true);

                const name = document.getElementById('register-name').value;
                const email = document.getElementById('register-email').value;
                const password = document.getElementById('register-password').value;
                const role = registerRoleInput.value;
                const errorEl = document.getElementById('register-error');
                errorEl.classList.add('hidden');

                const options = { data: { full_name: name, role: role, email: email } };

                if (role === 'doctor') {
                    const licenseId = document.getElementById('doctor-id').value;
                    if (!licenseId) {
                        errorEl.textContent = "Medical License ID is required for doctors.";
                        errorEl.classList.remove('hidden');
                        toggleButtonLoading(submitBtn, false);
                        return;
                    }
                    options.data.license_id = licenseId;
                }

                const { error: signUpError } = await _supabase.auth.signUp({ email, password, options });

                if (signUpError) {
                    errorEl.textContent = signUpError.message;
                    errorEl.classList.remove('hidden');
                } else {
                    showToast("Registration successful! Please check your email to verify your account.", "success");
                    showLoginForm();
                    registerForm.reset();
                }
                toggleButtonLoading(submitBtn, false);
            });

             // --- Chat Widget Logic ---
            const chatWindow = document.getElementById('chat-window');
            const chatToggleBtn = document.getElementById('chat-toggle-btn');
            const closeChatBtn = document.getElementById('close-chat-btn');
            const chatMessages = document.getElementById('chat-messages');
            const chatForm = document.getElementById('chat-form');
            const chatInput = document.getElementById('chat-input');
            let chatInitiated = false;

            const addChatMessage = (message, sender, isTyping = false) => {
                const messageEl = document.createElement('div');
                
                if (isTyping) {
                    messageEl.innerHTML = `<span class="typing-indicator"><span></span><span></span><span></span></span>`;
                    messageEl.id = 'typing-indicator';
                } else {
                    messageEl.textContent = message;
                }

                messageEl.className = 'p-2 rounded-lg max-w-[80%]';
                if (sender === 'bot') {
                    messageEl.classList.add('bg-gray-200', 'dark:bg-gray-700', 'self-start');
                } else {
                    messageEl.classList.add('bg-green-500', 'text-white', 'self-end');
                }
                chatMessages.appendChild(messageEl);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            };

            const getBotResponse = (userInput) => {
                const text = userInput.toLowerCase();
                let response = "I'm sorry, I don't understand. Can I help with finding a doctor, checking symptoms, or finding medicine?";

                if (text.includes('doctor') || text.includes('appointment')) {
                    response = "You can find our doctors and book a consultation by clicking on the 'Doctors' section in the menu.";
                } else if (text.includes('medicine')) {
                    response = "Please log in and use the 'Medicine Tracker' feature under our Services.";
                } else if (text.includes('symptom')) {
                    response = "You can use our AI Symptom Checker under the 'Services' menu.";
                } else if (text.includes('hello') || text.includes('hi')) {
                    response = "Hello there! How can I assist you today?";
                }
                
                addChatMessage('', 'bot', true); // Show typing indicator

                setTimeout(() => {
                    const typingIndicator = document.getElementById('typing-indicator');
                    if(typingIndicator) typingIndicator.remove();
                    addChatMessage(response, 'bot')
                }, 1200);
            };

            const initChat = () => {
                if (chatInitiated) return;
                const hours = new Date().getHours();
                let greeting = "Hello! I'm HealthBot. How can I help you today?";
                if (hours < 6 || hours > 22) { // Consider offline hours 10 PM to 6 AM
                    greeting = "Hello! Our support team is currently offline, but I'm HealthBot. How can I help you?";
                }
                addChatMessage(greeting, 'bot');
                chatInitiated = true;
            };

            chatToggleBtn.addEventListener('click', () => {
                chatWindow.classList.toggle('active');
                initChat();
            });
            closeChatBtn.addEventListener('click', () => chatWindow.classList.remove('active'));

            chatForm.addEventListener('submit', e => {
                e.preventDefault();
                const userInput = chatInput.value.trim();
                if (userInput) {
                    addChatMessage(userInput, 'user');
                    getBotResponse(userInput);
                    chatInput.value = '';
                }
            });

            // --- 8. INITIAL APP LOADER ---
            const initializeApp = async () => {
                 // Initialize EmailJS
                if (EMAILJS_PUBLIC_KEY !== 'YOUR_PUBLIC_KEY' && EMAILJS_PUBLIC_KEY !== 'user_xxxxxxxxxxxxxxxx') {
                    emailjs.init(EMAILJS_PUBLIC_KEY);
                }
                
                _supabase.auth.onAuthStateChange(async (event, session) => {
                    if (session) {
                        const { data: profile } = await _supabase
                            .from('profiles')
                            .select('*')
                            .eq('id', session.user.id)
                            .single();
                        currentUser = profile;
                    } else {
                        currentUser = null;
                    }
                    updateNavUI();
                });
                
                const { data: { session } } = await _supabase.auth.getSession();
                if (session) {
                     const { data: profile } = await _supabase
                         .from('profiles')
                         .select('*')
                         .eq('id', session.user.id)
                         .single();
                    currentUser = profile;
                }
                updateNavUI();
                fetchAndRenderDoctors();
            };
            
            initializeApp();
        });
    </script>
</body>
</html>


